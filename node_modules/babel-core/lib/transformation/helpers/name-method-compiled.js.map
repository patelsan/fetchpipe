{"version":3,"sources":["name-method.js"],"names":[],"mappings":"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","file":"name-method-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.custom = custom;\nexports.property = property;\nexports.bare = bare;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _getFunctionArity = require(\"./get-function-arity\");\n\nvar _getFunctionArity2 = _interopRequireDefault(_getFunctionArity);\n\nvar _util = require(\"../../util\");\n\nvar util = _interopRequireWildcard(_util);\n\nvar _types = require(\"../../types\");\n\nvar t = _interopRequireWildcard(_types);\n\n/**\n * [Please add a description.]\n */\n\nfunction visitIdentifier(context, node, scope, state) {\n  // check if this node matches our function id\n  if (node.name !== state.name) return;\n\n  // check that we don't have a local variable declared as that removes the need\n  // for the wrapper\n  var localDeclar = scope.getBindingIdentifier(state.name);\n  if (localDeclar !== state.outerDeclar) return;\n\n  state.selfReference = true;\n  context.stop();\n}\n\n/**\n * [Please add a description.]\n */\n\nvar visitor = {\n\n  /**\n   * [Please add a description.]\n   */\n\n  ReferencedIdentifier: function ReferencedIdentifier(node, parent, scope, state) {\n    visitIdentifier(this, node, scope, state);\n  },\n\n  /**\n   * [Please add a description.]\n   */\n\n  BindingIdentifier: function BindingIdentifier(node, parent, scope, state) {\n    visitIdentifier(this, node, scope, state);\n  }\n};\n\n/**\n * [Please add a description.]\n */\n\nvar wrap = function wrap(state, method, id, scope) {\n  if (state.selfReference) {\n    if (scope.hasBinding(id.name) && !scope.hasGlobal(id.name)) {\n      // we can just munge the local binding\n      scope.rename(id.name);\n    } else {\n      // need to add a wrapper since we can't change the references\n      var templateName = \"property-method-assignment-wrapper\";\n      if (method.generator) templateName += \"-generator\";\n      var template = util.template(templateName, {\n        FUNCTION: method,\n        FUNCTION_ID: id,\n        FUNCTION_KEY: scope.generateUidIdentifier(id.name)\n      });\n      template.callee._skipModulesRemap = true;\n\n      // shim in dummy params to retain function arity, if you try to read the\n      // source then you'll get the original since it's proxied so it's all good\n      var params = template.callee.body.body[0].params;\n      for (var i = 0, len = _getFunctionArity2[\"default\"](method); i < len; i++) {\n        params.push(scope.generateUidIdentifier(\"x\"));\n      }\n\n      return template;\n    }\n  }\n\n  method.id = id;\n  scope.getProgramParent().references[id.name] = true;\n};\n\n/**\n * [Please add a description.]\n */\n\nvar visit = function visit(node, name, scope) {\n  var state = {\n    selfAssignment: false,\n    selfReference: false,\n    outerDeclar: scope.getBindingIdentifier(name),\n    references: [],\n    name: name\n  };\n\n  // check to see if we have a local binding of the id we're setting inside of\n  // the function, this is important as there are caveats associated\n\n  var binding = scope.getOwnBinding(name);\n\n  if (binding) {\n    if (binding.kind === \"param\") {\n      // safari will blow up in strict mode with code like:\n      //\n      //   var t = function t(t) {};\n      //\n      // with the error:\n      //\n      //   Cannot declare a parameter named 't' as it shadows the name of a\n      //   strict mode function.\n      //\n      // this isn't to the spec and they've invented this behaviour which is\n      // **extremely** annoying so we avoid setting the name if it has a param\n      // with the same id\n      state.selfReference = true;\n    } else {\n      // otherwise it's defined somewhere in scope like:\n      //\n      //   var t = function () {\n      //     var t = 2;\n      //   };\n      //\n      // so we can safely just set the id and move along as it shadows the\n      // bound function id\n    }\n  } else if (state.outerDeclar || scope.hasGlobal(name)) {\n      scope.traverse(node, visitor, state);\n    }\n\n  return state;\n};\n\n/**\n * [Please add a description.]\n */\n\nfunction custom(node, id, scope) {\n  var state = visit(node, id.name, scope);\n  return wrap(state, node, id, scope);\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction property(node, file, scope) {\n  var key = t.toComputedKey(node, node.key);\n  if (!t.isLiteral(key)) return; // we can't set a function id with this\n\n  var name = t.toBindingIdentifierName(key.value);\n  var id = t.identifier(name);\n\n  var method = node.value;\n  var state = visit(method, name, scope);\n  node.value = wrap(state, method, id, scope) || method;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction bare(node, parent, scope) {\n  // has an `id` so we don't need to infer one\n  if (node.id) return;\n\n  var id;\n  if (t.isProperty(parent) && parent.kind === \"init\" && (!parent.computed || t.isLiteral(parent.key))) {\n    // { foo() {} };\n    id = parent.key;\n  } else if (t.isVariableDeclarator(parent)) {\n    // var foo = function () {};\n    id = parent.id;\n\n    if (t.isIdentifier(id)) {\n      var binding = scope.parent.getBinding(id.name);\n      if (binding && binding.constant && scope.getBinding(id.name) === binding) {\n        // always going to reference this method\n        node.id = id;\n        return;\n      }\n    }\n  } else {\n    return;\n  }\n\n  var name;\n  if (t.isLiteral(id)) {\n    name = id.value;\n  } else if (t.isIdentifier(id)) {\n    name = id.name;\n  } else {\n    return;\n  }\n\n  name = t.toBindingIdentifierName(name);\n  id = t.identifier(name);\n\n  var state = visit(node, name, scope);\n  return wrap(state, node, id, scope);\n}"]}