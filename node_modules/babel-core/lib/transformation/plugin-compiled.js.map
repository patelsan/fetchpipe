{"version":3,"sources":["plugin.js"],"names":[],"mappings":"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","file":"plugin-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// istanbul ignore next\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _pluginPass = require(\"./plugin-pass\");\n\nvar _pluginPass2 = _interopRequireDefault(_pluginPass);\n\nvar _messages = require(\"../messages\");\n\nvar messages = _interopRequireWildcard(_messages);\n\nvar _traversal = require(\"../traversal\");\n\nvar _traversal2 = _interopRequireDefault(_traversal);\n\nvar _lodashObjectAssign = require(\"lodash/object/assign\");\n\nvar _lodashObjectAssign2 = _interopRequireDefault(_lodashObjectAssign);\n\nvar _lodashLangClone = require(\"lodash/lang/clone\");\n\nvar _lodashLangClone2 = _interopRequireDefault(_lodashLangClone);\n\nvar _file = require(\"./file\");\n\nvar _file2 = _interopRequireDefault(_file);\n\nvar _types = require(\"../types\");\n\nvar t = _interopRequireWildcard(_types);\n\nvar VALID_PLUGIN_PROPERTIES = [\"visitor\", \"metadata\", \"manipulateOptions\", \"post\", \"pre\"];\n\nvar VALID_METADATA_PROPERTIES = [\"dependencies\", \"optional\", \"stage\", \"group\", \"experimental\", \"secondPass\"];\n\n/**\n * [Please add a description.]\n */\n\nvar Plugin = (function () {\n  function Plugin(key, plugin) {\n    _classCallCheck(this, Plugin);\n\n    Plugin.validate(key, plugin);\n\n    plugin = _lodashObjectAssign2[\"default\"]({}, plugin);\n\n    var take = function take(key) {\n      var val = plugin[key];\n      delete plugin[key];\n      return val;\n    };\n\n    this.manipulateOptions = take(\"manipulateOptions\");\n    this.metadata = take(\"metadata\") || {};\n    this.dependencies = this.metadata.dependencies || [];\n    this.post = take(\"post\");\n    this.pre = take(\"pre\");\n\n    //\n\n    if (this.metadata.stage != null) {\n      this.metadata.optional = true;\n    }\n\n    //\n\n    this.visitor = this.normalize(_lodashLangClone2[\"default\"](take(\"visitor\")) || {});\n    this.key = key;\n  }\n\n  /**\n   * [Please add a description.]\n   */\n\n  Plugin.validate = function validate(name, plugin) {\n    for (var key in plugin) {\n      if (key[0] === \"_\") continue;\n      if (VALID_PLUGIN_PROPERTIES.indexOf(key) >= 0) continue;\n\n      var msgType = \"pluginInvalidProperty\";\n      if (t.TYPES.indexOf(key) >= 0) msgType = \"pluginInvalidPropertyVisitor\";\n      throw new Error(messages.get(msgType, name, key));\n    }\n\n    for (var key in plugin.metadata) {\n      if (VALID_METADATA_PROPERTIES.indexOf(key) >= 0) continue;\n\n      throw new Error(messages.get(\"pluginInvalidProperty\", name, \"metadata.\" + key));\n    }\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Plugin.prototype.normalize = function normalize(visitor) {\n    _traversal2[\"default\"].explode(visitor);\n    return visitor;\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  Plugin.prototype.buildPass = function buildPass(file) {\n    // validate Transformer instance\n    if (!(file instanceof _file2[\"default\"])) {\n      throw new TypeError(messages.get(\"pluginNotFile\", this.key));\n    }\n\n    return new _pluginPass2[\"default\"](file, this);\n  };\n\n  return Plugin;\n})();\n\nexports[\"default\"] = Plugin;\nmodule.exports = exports[\"default\"];"]}