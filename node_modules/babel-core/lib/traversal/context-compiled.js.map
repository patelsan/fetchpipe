{"version":3,"sources":["context.js"],"names":[],"mappings":"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","file":"context-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n// istanbul ignore next\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj[\"default\"] = obj; return newObj; } }\n\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// istanbul ignore next\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _path = require(\"./path\");\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _types = require(\"../types\");\n\nvar t = _interopRequireWildcard(_types);\n\n/**\n * [Please add a description.]\n */\n\nvar TraversalContext = (function () {\n  function TraversalContext(scope, opts, state, parentPath) {\n    _classCallCheck(this, TraversalContext);\n\n    this.queue = null;\n\n    this.parentPath = parentPath;\n    this.scope = scope;\n    this.state = state;\n    this.opts = opts;\n  }\n\n  /**\n   * [Please add a description.]\n   */\n\n  TraversalContext.prototype.shouldVisit = function shouldVisit(node) {\n    var opts = this.opts;\n    if (opts.enter || opts.exit) return true;\n\n    if (opts[node.type]) return true;\n\n    var keys = t.VISITOR_KEYS[node.type];\n    if (!keys || !keys.length) return false;\n\n    var _arr = keys;\n    for (var _i = 0; _i < _arr.length; _i++) {\n      var key = _arr[_i];\n      if (node[key]) return true;\n    }\n\n    return false;\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  TraversalContext.prototype.create = function create(node, obj, key, listKey) {\n    var path = _path2[\"default\"].get({\n      parentPath: this.parentPath,\n      parent: node,\n      container: obj,\n      key: key,\n      listKey: listKey\n    });\n    path.unshiftContext(this);\n    return path;\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  TraversalContext.prototype.visitMultiple = function visitMultiple(container, parent, listKey) {\n    // nothing to traverse!\n    if (container.length === 0) return false;\n\n    var visited = [];\n\n    var queue = this.queue = [];\n    var stop = false;\n\n    // build up initial queue\n    for (var key = 0; key < container.length; key++) {\n      var self = container[key];\n      if (self && this.shouldVisit(self)) {\n        queue.push(this.create(parent, container, key, listKey));\n      }\n    }\n\n    // visit the queue\n    var _arr2 = queue;\n    for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n      var path = _arr2[_i2];\n      path.resync();\n\n      if (visited.indexOf(path.node) >= 0) continue;\n      visited.push(path.node);\n\n      if (path.visit()) {\n        stop = true;\n        break;\n      }\n    }\n\n    var _arr3 = queue;\n    for (var _i3 = 0; _i3 < _arr3.length; _i3++) {\n      var path = _arr3[_i3];\n      path.shiftContext();\n    }\n\n    this.queue = null;\n\n    return stop;\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  TraversalContext.prototype.visitSingle = function visitSingle(node, key) {\n    if (this.shouldVisit(node[key])) {\n      var path = this.create(node, node, key);\n      path.visit();\n      path.shiftContext();\n    }\n  };\n\n  /**\n   * [Please add a description.]\n   */\n\n  TraversalContext.prototype.visit = function visit(node, key) {\n    var nodes = node[key];\n    if (!nodes) return;\n\n    if (Array.isArray(nodes)) {\n      return this.visitMultiple(nodes, node, key);\n    } else {\n      return this.visitSingle(node, key);\n    }\n  };\n\n  return TraversalContext;\n})();\n\nexports[\"default\"] = TraversalContext;\nmodule.exports = exports[\"default\"];"]}