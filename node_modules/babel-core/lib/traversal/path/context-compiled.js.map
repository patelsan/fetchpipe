{"version":3,"sources":["context.js"],"names":[],"mappings":"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","file":"context-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.call = call;\nexports.isBlacklisted = isBlacklisted;\nexports.visit = visit;\nexports.skip = skip;\nexports.skipKey = skipKey;\nexports.stop = stop;\nexports.setScope = setScope;\nexports.setContext = setContext;\nexports.resync = resync;\nexports._resyncParent = _resyncParent;\nexports._resyncKey = _resyncKey;\nexports._resyncList = _resyncList;\nexports._resyncRemoved = _resyncRemoved;\nexports.shiftContext = shiftContext;\nexports.unshiftContext = unshiftContext;\nexports.setup = setup;\nexports.setKey = setKey;\nexports.queueNode = queueNode;\n// istanbul ignore next\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _index = require(\"../index\");\n\nvar _index2 = _interopRequireDefault(_index);\n\n/**\n * [Please add a description.]\n */\n\nfunction call(key) {\n  var node = this.node;\n  if (!node) return;\n\n  var opts = this.opts;\n\n  var _arr = [opts[key], opts[node.type] && opts[node.type][key]];\n  for (var _i = 0; _i < _arr.length; _i++) {\n    var fns = _arr[_i];\n    if (!fns) continue;\n\n    var _arr2 = fns;\n    for (var _i2 = 0; _i2 < _arr2.length; _i2++) {\n      var fn = _arr2[_i2];\n      if (!fn) continue;\n\n      var _node = this.node;\n      if (!_node) return;\n\n      var previousType = this.type;\n\n      // call the function with the params (node, parent, scope, state)\n      var replacement = fn.call(this, _node, this.parent, this.scope, this.state);\n\n      if (replacement) {\n        this.replaceWith(replacement, true);\n      }\n\n      if (this.shouldStop || this.shouldSkip || this.removed) return;\n\n      if (previousType !== this.type) {\n        this.queueNode(this);\n        return;\n      }\n    }\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction isBlacklisted() {\n  var blacklist = this.opts.blacklist;\n  return blacklist && blacklist.indexOf(this.node.type) > -1;\n}\n\n/**\n * Visits a node and calls appropriate enter and exit callbacks\n * as required.\n */\n\nfunction visit() {\n  if (this.isBlacklisted()) return false;\n  if (this.opts.shouldSkip && this.opts.shouldSkip(this)) return false;\n\n  this.call(\"enter\");\n\n  if (this.shouldSkip) {\n    return this.shouldStop;\n  }\n\n  var node = this.node;\n  var opts = this.opts;\n\n  if (node) {\n    if (Array.isArray(node)) {\n      // traverse over these replacement nodes we purposely don't call exitNode\n      // as the original node has been destroyed\n      for (var i = 0; i < node.length; i++) {\n        _index2[\"default\"].node(node[i], opts, this.scope, this.state, this, this.skipKeys);\n      }\n    } else {\n      _index2[\"default\"].node(node, opts, this.scope, this.state, this, this.skipKeys);\n      this.call(\"exit\");\n    }\n  }\n\n  return this.shouldStop;\n}\n\n/**\n * Sets shouldSkip flag true so that this node will be skipped while visiting.\n */\n\nfunction skip() {\n  this.shouldSkip = true;\n}\n\n/**\n * Adds given key to the list of keys to be skipped.\n */\n\nfunction skipKey(key) {\n  this.skipKeys[key] = true;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction stop() {\n  this.shouldStop = true;\n  this.shouldSkip = true;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setScope() {\n  if (this.opts && this.opts.noScope) return;\n\n  var target = this.context || this.parentPath;\n  this.scope = this.getScope(target && target.scope);\n  if (this.scope) this.scope.init();\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setContext(context) {\n  this.shouldSkip = false;\n  this.shouldStop = false;\n  this.removed = false;\n  this.skipKeys = {};\n\n  if (context) {\n    this.context = context;\n    this.state = context.state;\n    this.opts = context.opts;\n  }\n\n  this.setScope();\n\n  return this;\n}\n\n/**\n * Here we resync the node paths `key` and `container`. If they've changed according\n * to what we have stored internally then we attempt to resync by crawling and looking\n * for the new values.\n */\n\nfunction resync() {\n  if (this.removed) return;\n\n  this._resyncParent();\n  this._resyncList();\n  this._resyncKey();\n  //this._resyncRemoved();\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncParent() {\n  if (this.parentPath) {\n    this.parent = this.parentPath.node;\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncKey() {\n  if (!this.container) return;\n\n  if (this.node === this.container[this.key]) return;\n\n  // grrr, path key is out of sync. this is likely due to a modification to the AST\n  // not done through our path APIs\n\n  if (Array.isArray(this.container)) {\n    for (var i = 0; i < this.container.length; i++) {\n      if (this.container[i] === this.node) {\n        return this.setKey(i);\n      }\n    }\n  } else {\n    for (var key in this.container) {\n      if (this.container[key] === this.node) {\n        return this.setKey(key);\n      }\n    }\n  }\n\n  this.key = null;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncList() {\n  var listKey = this.listKey;\n  var parentPath = this.parentPath;\n  if (!listKey || !parentPath) return;\n\n  var newContainer = parentPath.node[listKey];\n  if (this.container === newContainer) return;\n\n  // container is out of sync. this is likely the result of it being reassigned\n\n  if (newContainer) {\n    this.container = newContainer;\n  } else {\n    this.container = null;\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction _resyncRemoved() {\n  if (this.key == null || !this.container || this.container[this.key] !== this.node) {\n    this._markRemoved();\n  }\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction shiftContext() {\n  this.contexts.shift();\n  this.setContext(this.contexts[0]);\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction unshiftContext(context) {\n  this.contexts.unshift(context);\n  this.setContext(context);\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setup(parentPath, container, listKey, key) {\n  this.inList = !!listKey;\n  this.listKey = listKey;\n  this.parentKey = listKey || key;\n  this.container = container;\n\n  this.parentPath = parentPath || this.parentPath;\n  this.setKey(key);\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction setKey(key) {\n  this.key = key;\n  this.node = this.container[this.key];\n  this.type = this.node && this.node.type;\n}\n\n/**\n * [Please add a description.]\n */\n\nfunction queueNode(path) {\n  var _arr3 = this.contexts;\n\n  for (var _i3 = 0; _i3 < _arr3.length; _i3++) {\n    var context = _arr3[_i3];\n    if (context.queue) {\n      context.queue.push(path);\n    }\n  }\n}"]}