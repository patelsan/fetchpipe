{"version":3,"sources":["defs-cmd.js"],"names":[],"mappings":"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","file":"defs-cmd-compiled.js","sourcesContent":["\"use strict\";\n\nvar fs = require(\"fs\");\nvar fmt = require(\"simple-fmt\");\nvar tryor = require(\"tryor\");\nvar defs = require(\"./defs-main\");\nvar version = \"1.1.0\";\nvar yargs = require(\"yargs\")\n    .options(\"config\", {});\nvar argv = yargs.argv;\n\nif (!argv._.length) {\n    var usage = [\n        \"defs v\" + version + \"\",\n        \"\",\n        \"Usage: defs OPTIONS <file>\",\n        \"\",\n        \"Options: \",\n        \"  --config  use specified defs-config.js instead of searching for it\",\n    ].join(\"\\n\");\n    console.error(usage);\n    process.exit(-1);\n}\nvar filename = argv._[0];\n\nif (!fs.existsSync(filename)) {\n    console.error(\"error: file not found <%s>\", filename);\n    process.exit(-1);\n}\n\nvar src = String(fs.readFileSync(filename));\n\nvar config = findAndReadConfig();\n\nvar ret = defs(src, config);\nif (ret.errors) {\n    process.stderr.write(ret.errors.join(\"\\n\"));\n    process.stderr.write(\"\\n\");\n    process.exit(-1);\n}\n\nif (config.stats) {\n    process.stdout.write(ret.stats.toString());\n    process.exit(0);\n}\nif (ret.ast) {\n    process.stdout.write(JSON.stringify(ret.ast, null, 4));\n}\nif (ret.src) {\n    process.stdout.write(ret.src);\n}\n\nfunction findAndReadConfig() {\n    if (argv.config) {\n        var config = tryor(function() { return String(fs.readFileSync(argv.config)) }, null);\n        if (!config) {\n            console.error(\"error: config file not found <%s>\", argv.config);\n            process.exit(-1);\n        }\n        var json = tryor(function() { return JSON.parse(config) }, null);\n        if (!json) {\n            console.error(\"error: config file is not valid JSON <%s>\", argv.config);\n            process.exit(-1);\n        }\n        return json;\n    }\n\n    var path = \"\";\n    var filename = \"defs-config.json\";\n    var filenamePath = null;\n\n    while (fs.existsSync(path || \".\")) {\n        filenamePath = path + filename;\n        if (fs.existsSync(filenamePath)) {\n            var config$0 = tryor(function() {\n                return JSON.parse(String(fs.readFileSync(filenamePath)));\n            }, null);\n            if (config$0 === null) {\n                console.error(\"error: config file is not valid JSON <%s>\", filenamePath);\n                process.exit(-1);\n            }\n            return config$0;\n        }\n\n        path = \"../\" + path;\n    }\n\n    return {};\n}"]}