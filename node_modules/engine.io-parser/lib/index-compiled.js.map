{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/**\n * Module dependencies.\n */\n\nvar utf8 = require('utf8');\nvar after = require('after');\nvar keys = require('./keys');\n\n/**\n * Current protocol version.\n */\nexports.protocol = 3;\n\n/**\n * Packet types.\n */\n\nvar packets = exports.packets = {\n    open:     0    // non-ws\n  , close:    1    // non-ws\n  , ping:     2\n  , pong:     3\n  , message:  4\n  , upgrade:  5\n  , noop:     6\n};\n\nvar packetslist = keys(packets);\n\n/**\n * Premade error packet.\n */\n\nvar err = { type: 'error', data: 'parser error' };\n\n/**\n * Encodes a packet.\n *\n *     <packet type id> [ <data> ]\n *\n * Example:\n *\n *     5hello world\n *     3\n *     4\n *\n * Binary is encoded in an identical principle\n *\n * @api private\n */\n\nexports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {\n  if ('function' == typeof supportsBinary) {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  if ('function' == typeof utf8encode ) {\n    callback = utf8encode;\n    utf8encode = null;\n  }\n\n  if (Buffer.isBuffer(packet.data)) {\n    return encodeBuffer(packet, supportsBinary, callback);\n  } else if (packet.data && (packet.data.buffer || packet.data) instanceof ArrayBuffer) {\n    return encodeArrayBuffer(packet, supportsBinary, callback);\n  }\n\n  // Sending data as a utf-8 string\n  var encoded = packets[packet.type];\n\n  // data fragment is optional\n  if (undefined !== packet.data) {\n    encoded += utf8encode ? utf8.encode(String(packet.data)) : String(packet.data);\n  }\n\n  return callback('' + encoded);\n};\n\n/**\n * Encode Buffer data\n */\n\nfunction encodeBuffer(packet, supportsBinary, callback) {\n  var data = packet.data;\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var typeBuffer = new Buffer(1);\n  typeBuffer[0] = packets[packet.type];\n  return callback(Buffer.concat([typeBuffer, data]));\n}\n\nfunction encodeArrayBuffer(packet, supportsBinary, callback) {\n\n  var data = packet.data.buffer || packet.data;\n\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var contentArray = new Uint8Array(data);\n  var resultBuffer = new Buffer(1 + data.byteLength);\n\n  resultBuffer[0] = packets[packet.type];\n  for (var i = 0; i < contentArray.length; i++){\n    resultBuffer[i+1] = contentArray[i];\n  }\n  return callback(resultBuffer);\n}\n\n/**\n * Encodes a packet with binary data in a base64 string\n *\n * @param {Object} packet, has `type` and `data`\n * @return {String} base64 encoded message\n */\n\nexports.encodeBase64Packet = function(packet, callback){\n\n  if (!Buffer.isBuffer(packet.data)) {\n    var buf = new Buffer(packet.data.byteLength);\n    for (var i = 0; i < buf.length; i++) {\n      buf[i] = packet.data[i];\n    }\n    packet.data = buf;\n  }\n\n  var message = 'b' + packets[packet.type];\n  message += packet.data.toString('base64');\n  return callback(message);\n};\n\n/**\n * Decodes a packet. Data also available as an ArrayBuffer if requested.\n *\n * @return {Object} with `type` and `data` (if any)\n * @api private\n */\n\nexports.decodePacket = function (data, binaryType, utf8decode) {\n  // String data\n  if (typeof data == 'string' || data === undefined) {\n    if (data.charAt(0) == 'b') {\n      return exports.decodeBase64Packet(data.substr(1), binaryType);\n    }\n\n    var type = data.charAt(0);\n    if (utf8decode) {\n      try {\n        data = utf8.decode(data);\n      } catch (e) {\n        return err;\n      }\n    }\n\n    if (Number(type) != type || !packetslist[type]) {\n      return err;\n    }\n\n    if (data.length > 1) {\n      return { type: packetslist[type], data: data.substring(1) };\n    } else {\n      return { type: packetslist[type] };\n    }\n  }\n\n  // Binary data\n  if (binaryType === 'arraybuffer') {\n    var type = data[0];\n    var intArray = new Uint8Array(data.length - 1);\n    for (var i = 1; i < data.length; i++) {\n      intArray[i - 1] = data[i];\n    }\n    return { type: packetslist[type], data: intArray.buffer };\n  }\n  var type = data[0];\n  return { type: packetslist[type], data: data.slice(1) };\n};\n\n/**\n * Decodes a packet encoded in a base64 string.\n *\n * @param {String} base64 encoded message\n * @return {Object} with `type` and `data` (if any)\n */\n\nexports.decodeBase64Packet = function(msg, binaryType) {\n  var type = packetslist[msg.charAt(0)];\n  var data = new Buffer(msg.substr(1), 'base64');\n  if (binaryType === 'arraybuffer') {\n    var abv = new Uint8Array(data.length);\n    for (var i = 0; i < abv.length; i++){\n      abv[i] = data[i];\n    }\n    data = abv.buffer;\n  }\n  return { type: type, data: data };\n};\n\n/**\n * Encodes multiple messages (payload).\n *\n *     <length>:data\n *\n * Example:\n *\n *     11:hello world2:hi\n *\n * If any contents are binary, they will be encoded as base64 strings. Base64\n * encoded strings are marked with a b before the length specifier\n *\n * @param {Array} packets\n * @api private\n */\n\nexports.encodePayload = function (packets, supportsBinary, callback) {\n  if (typeof supportsBinary == 'function') {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  if (supportsBinary) {\n    return exports.encodePayloadAsBinary(packets, callback);\n  }\n\n  if (!packets.length) {\n    return callback('0:');\n  }\n\n  function setLengthHeader(message) {\n    return message.length + ':' + message;\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, supportsBinary, true, function(message) {\n      doneCallback(null, setLengthHeader(message));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(results.join(''));\n  });\n};\n\n/**\n * Async array map using after\n */\n\nfunction map(ary, each, done) {\n  var result = new Array(ary.length);\n  var next = after(ary.length, done);\n\n  var eachWithIndex = function(i, el, cb) {\n    each(el, function(error, msg) {\n      result[i] = msg;\n      cb(error, result);\n    });\n  };\n\n  for (var i = 0; i < ary.length; i++) {\n    eachWithIndex(i, ary[i], next);\n  }\n}\n\n/*\n * Decodes data when a payload is maybe expected. Possible binary contents are\n * decoded from their base64 representation\n *\n * @param {String} data, callback method\n * @api public\n */\n\nexports.decodePayload = function (data, binaryType, callback) {\n  if ('string' != typeof data) {\n    return exports.decodePayloadAsBinary(data, binaryType, callback);\n  }\n\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var packet;\n  if (data == '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n  var length = ''\n    , n, msg;\n\n  for (var i = 0, l = data.length; i < l; i++) {\n    var chr = data.charAt(i);\n\n    if (':' != chr) {\n      length += chr;\n    } else {\n      if ('' == length || (length != (n = Number(length)))) {\n        // parser error - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      msg = data.substr(i + 1, n);\n\n      if (length != msg.length) {\n        // parser error - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      if (msg.length) {\n        packet = exports.decodePacket(msg, binaryType, true);\n\n        if (err.type == packet.type && err.data == packet.data) {\n          // parser error in individual packet - ignoring payload\n          return callback(err, 0, 1);\n        }\n\n        var ret = callback(packet, i + n, l);\n        if (false === ret) return;\n      }\n\n      // advance cursor\n      i += n;\n      length = '';\n    }\n  }\n\n  if (length != '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n};\n\n/**\n *\n * Converts a buffer to a utf8.js encoded string\n *\n * @api private\n */\n\nfunction bufferToString(buffer) {\n  var str = '';\n  for (var i = 0; i < buffer.length; i++) {\n    str += String.fromCharCode(buffer[i]);\n  }\n  return str;\n}\n\n/**\n *\n * Converts a utf8.js encoded string to a buffer\n *\n * @api private\n */\n\nfunction stringToBuffer(string) {\n  var buf = new Buffer(string.length);\n  for (var i = 0; i < string.length; i++) {\n    buf.writeUInt8(string.charCodeAt(i), i);\n  }\n  return buf;\n}\n\n/**\n * Encodes multiple messages (payload) as binary.\n *\n * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number\n * 255><data>\n *\n * Example:\n * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers\n *\n * @param {Array} packets\n * @return {Buffer} encoded payload\n * @api private\n */\n\nexports.encodePayloadAsBinary = function (packets, callback) {\n  if (!packets.length) {\n    return callback(new Buffer(0));\n  }\n\n  function encodeOne(p, doneCallback) {\n    exports.encodePacket(p, true, true, function(packet) {\n\n      if (typeof packet === 'string') {\n        var encodingLength = '' + packet.length;\n        var sizeBuffer = new Buffer(encodingLength.length + 2);\n        sizeBuffer[0] = 0; // is a string (not true binary = 0)\n        for (var i = 0; i < encodingLength.length; i++) {\n          sizeBuffer[i + 1] = parseInt(encodingLength[i], 10);\n        }\n        sizeBuffer[sizeBuffer.length - 1] = 255;\n        return doneCallback(null, Buffer.concat([sizeBuffer, stringToBuffer(packet)]));\n      }\n\n      var encodingLength = '' + packet.length;\n      var sizeBuffer = new Buffer(encodingLength.length + 2);\n      sizeBuffer[0] = 1; // is binary (true binary = 1)\n      for (var i = 0; i < encodingLength.length; i++) {\n        sizeBuffer[i + 1] = parseInt(encodingLength[i], 10);\n      }\n      sizeBuffer[sizeBuffer.length - 1] = 255;\n      doneCallback(null, Buffer.concat([sizeBuffer, packet]));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(Buffer.concat(results));\n  });\n};\n\n/*\n * Decodes data when a payload is maybe expected. Strings are decoded by\n * interpreting each byte as a key code for entries marked to start with 0. See\n * description of encodePayloadAsBinary\n\n * @param {Buffer} data, callback method\n * @api public\n */\n\nexports.decodePayloadAsBinary = function (data, binaryType, callback) {\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var bufferTail = data;\n  var buffers = [];\n\n  while (bufferTail.length > 0) {\n    var strLen = '';\n    var isString = bufferTail[0] === 0;\n    var numberTooLong = false;\n    for (var i = 1; ; i++) {\n      if (bufferTail[i] == 255)  break;\n      // 310 = char length of Number.MAX_VALUE\n      if (strLen.length > 310) {\n        numberTooLong = true;\n        break;\n      }\n      strLen += '' + bufferTail[i];\n    }\n    if(numberTooLong) return callback(err, 0, 1);\n    bufferTail = bufferTail.slice(strLen.length + 1);\n\n    var msgLength = parseInt(strLen, 10);\n\n    var msg = bufferTail.slice(1, msgLength + 1);\n    if (isString) msg = bufferToString(msg);\n    buffers.push(msg);\n    bufferTail = bufferTail.slice(msgLength + 1);\n  }\n\n  var total = buffers.length;\n  buffers.forEach(function(buffer, i) {\n    callback(exports.decodePacket(buffer, binaryType, true), i, total);\n  });\n};\n"]}