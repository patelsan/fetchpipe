{"version":3,"sources":["trackergroup.js"],"names":[],"mappings":"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","file":"trackergroup-compiled.js","sourcesContent":["\"use strict\"\nvar test = require(\"tap\").test\nvar Tracker = require(\"../index.js\").Tracker\nvar TrackerGroup = require(\"../index.js\").TrackerGroup\n\nvar timeoutError = new Error(\"timeout\")\nvar testEvent = function (obj,event,next) {\n  var timeout = setTimeout(function(){\n    obj.removeListener(event, eventHandler)\n    next(timeoutError)\n  }, 10)\n  var eventHandler = function () {\n    var args = Array.prototype.slice.call(arguments)\n    args.unshift(null)\n    clearTimeout(timeout)\n    next.apply(null, args)\n  }\n  obj.once(event, eventHandler)\n}\n\ntest(\"TrackerGroup\", function (t) {\n  var name = \"test\"\n\n  var track = new TrackerGroup(name)\n  t.is(track.completed(), 0, \"Nothing todo is 0 completion\")\n  testEvent(track, \"change\", afterFinishEmpty)\n  track.finish()\n  var a, b\n  function afterFinishEmpty(er, onChangeName) {\n    t.is(er, null, \"finishEmpty: on change event fired\")\n    t.is(onChangeName, name, \"finishEmpty: on change emits the correct name\")\n    t.is(track.completed(), 1, \"finishEmpty: Finishing an empty group actually finishes it\")\n\n    track = new TrackerGroup(name)\n    a = track.newItem(\"a\", 10, 1)\n    b = track.newItem(\"b\", 10, 1)\n    t.is(track.completed(), 0, \"Initially empty\")\n    testEvent(track, \"change\", afterCompleteWork)\n    a.completeWork(5)\n  }\n  function afterCompleteWork(er, onChangeName) {\n    t.is(er, null, \"on change event fired\")\n    t.is(onChangeName, \"a\", \"on change emits the correct name\")\n    t.is(track.completed(), 0.25, \"Complete half of one is a quarter overall\")\n    testEvent(track, \"change\", afterFinishAll)\n    track.finish()\n  }\n  function afterFinishAll(er, onChangeName) {\n    t.is(er, null, \"finishAll: on change event fired\")\n    t.is(onChangeName, name, \"finishAll: on change emits the correct name\")\n    t.is(track.completed(), 1, \"Finishing everything \")\n    \n    track = new TrackerGroup(name)\n    a = track.newItem(\"a\", 10, 2)\n    b = track.newItem(\"b\", 10, 1)\n    t.is(track.completed(), 0, \"weighted: Initially empty\")\n    testEvent(track, \"change\", afterWeightedCompleteWork)\n    a.completeWork(5)\n  }\n  function afterWeightedCompleteWork(er, onChangeName) {\n    t.is(er, null, \"weighted: on change event fired\")\n    t.is(onChangeName, \"a\", \"weighted: on change emits the correct name\")\n    t.is(Math.round(track.completed()*100), 33, \"weighted: Complete half of double weighted\")\n    testEvent(track, \"change\", afterWeightedFinishAll)\n    track.finish()\n  }\n  function afterWeightedFinishAll(er, onChangeName) {\n    t.is(er, null, \"weightedFinishAll: on change event fired\")\n    t.is(onChangeName, name, \"weightedFinishAll: on change emits the correct name\")\n    t.is(track.completed(), 1, \"weightedFinishaAll: Finishing everything \")\n    \n    track = new TrackerGroup(name)\n    a = track.newGroup(\"a\", 10)\n    b = track.newGroup(\"b\", 10)\n    var a1 = a.newItem(\"a.1\",10)\n    a1.completeWork(5)\n    t.is(track.completed(), 0.25, \"nested: Initially quarter done\")\n    testEvent(track, \"change\", afterNestedComplete)\n    b.finish()\n  }\n  function afterNestedComplete(er, onChangeName) {\n    t.is(er, null, \"nestedComplete: on change event fired\")\n    t.is(onChangeName, \"b\", \"nestedComplete: on change emits the correct name\")\n    t.is(track.completed(), 0.75, \"nestedComplete: Finishing everything \")\n    t.end()\n  }\n})\n"]}