{"version":3,"sources":["join.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;AACb,MAAM,CAAC,OAAO,GACd,UAAS,OAAO,EAAE,YAAY,EAAE,mBAAmB,EAAE,QAAQ,EAAE;AAC/D,QAAI,IAAI,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAChC,QAAI,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;AACnC,QAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC7B,QAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC7B,QAAI,MAAM,CAAC;;AAEX,QAAI,CAAC,KAAK,EAAE;AACZ,YAAI,WAAW,EAAE;AACb,gBAAI,YAAY,GAAG,SAAf,YAAY,CAAY,CAAC,EAAE;AAC3B,uBAAO,IAAI,QAAQ,CAAC,OAAO,EAAE,QAAQ,EAAE;;;;aAIlC,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;aAC/B,CAAC;;AAEF,gBAAI,MAAM,GAAG,SAAT,MAAM,CAAY,KAAK,EAAE;AACzB,oBAAI,MAAM,GAAG,EAAE,CAAC;AAChB,qBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,KAAK,EAAE,EAAE,CAAC,EAAE,MAAM,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;AAC7D,uBAAO,IAAI,QAAQ,CAAC,QAAQ,EAAE;;;;aAIzB,CAAC,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aAChD,CAAC;AACF,gBAAI,aAAa,GAAG,EAAE,CAAC;AACvB,gBAAI,OAAO,GAAG,CAAC,SAAS,CAAC,CAAC;AAC1B,iBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,EAAE;AACzB,6BAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;AACpC,uBAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;aAC3B;;AAED,gBAAI,MAAM,GAAG,SAAT,MAAM,CAAY,KAAK,EAAE,EAAE,EAAE;AAC7B,oBAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC;AACvD,oBAAI,CAAC,EAAE,GAAG,EAAE,CAAC;AACb,oBAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACnB,oBAAI,CAAC,GAAG,GAAG,CAAC,CAAC;aAChB,CAAC;;AAEF,kBAAM,CAAC,SAAS,CAAC,OAAO,GAAG,OAAO,CAAC;AACnC,kBAAM,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAS,OAAO,EAAE;AAClD,oBAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;AACnB,mBAAG,EAAE,CAAC;AACN,oBAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;AACvB,oBAAI,GAAG,IAAI,KAAK,EAAE;AACd,wBAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;AAClC,2BAAO,CAAC,YAAY,EAAE,CAAC;AACvB,wBAAI,GAAG,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC;AAClC,2BAAO,CAAC,WAAW,EAAE,CAAC;AACtB,wBAAI,GAAG,KAAK,QAAQ,EAAE;AAClB,+BAAO,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;qBAC/C,MAAM;AACH,+BAAO,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;qBACjC;iBACJ,MAAM;AACH,wBAAI,CAAC,GAAG,GAAG,GAAG,CAAC;iBAClB;aACJ,CAAC;;AAEF,gBAAI,MAAM,GAAG,SAAT,MAAM,CAAa,MAAM,EAAE;AAC3B,oBAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;aACxB,CAAC;SACL;KACA;;AAED,WAAO,CAAC,IAAI,GAAG,YAAY;AACvB,YAAI,IAAI,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;AAChC,YAAI,EAAE,CAAC;AACP,YAAI,IAAI,GAAG,CAAC,IAAI,OAAO,SAAS,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;AACnD,cAAE,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;AACrB,gBAAI,CAAC,KAAK,EAAE;AACR,oBAAI,IAAI,GAAG,CAAC,IAAI,WAAW,EAAE;AACzB,wBAAI,GAAG,GAAG,IAAI,OAAO,CAAC,QAAQ,CAAC,CAAC;AAChC,uBAAG,CAAC,kBAAkB,EAAE,CAAC;AACzB,wBAAI,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;AAClC,wBAAI,SAAS,GAAG,aAAa,CAAC;AAC9B,yBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,EAAE,CAAC,EAAE;AAC3B,4BAAI,YAAY,GAAG,mBAAmB,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;AAC1D,4BAAI,YAAY,YAAY,OAAO,EAAE;AACjC,wCAAY,GAAG,YAAY,CAAC,OAAO,EAAE,CAAC;AACtC,gCAAI,YAAY,CAAC,UAAU,EAAE,EAAE;AAC3B,4CAAY,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,MAAM,EACpB,SAAS,EAAE,GAAG,EAAE,MAAM,CAAC,CAAC;6BAC9C,MAAM,IAAI,YAAY,CAAC,YAAY,EAAE,EAAE;AACpC,yCAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EACH,YAAY,CAAC,MAAM,EAAE,EAAE,MAAM,CAAC,CAAC;6BACpD,MAAM;AACH,mCAAG,CAAC,OAAO,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC,CAAC;6BACvC;yBACJ,MAAM;AACH,qCAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;yBAChD;qBACJ;AACD,2BAAO,GAAG,CAAC;iBACd;aACJ;SACJ;AACD,YAAI,KAAK,GAAG,SAAS,CAAC,MAAM,CAAC,IAAI,IAAI,GAAG,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC,AAAC,KAAI,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,EAAE,EAAE,GAAG,EAAE;AAAC,gBAAI,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;SAAC;AAC5H,YAAI,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;AACnB,YAAI,GAAG,GAAG,IAAI,YAAY,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,CAAC;AAC3C,eAAO,EAAE,KAAK,SAAS,GAAG,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC;KAClD,CAAC;CAED,CAAC","file":"join-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, tryConvertToPromise, INTERNAL) {\nvar util = require(\"./util.js\");\nvar canEvaluate = util.canEvaluate;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar reject;\n\nif (!false) {\nif (canEvaluate) {\n    var thenCallback = function(i) {\n        return new Function(\"value\", \"holder\", \"                             \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = value;                                           \\n\\\n            holder.checkFulfillment(this);                                   \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var caller = function(count) {\n        var values = [];\n        for (var i = 1; i <= count; ++i) values.push(\"holder.p\" + i);\n        return new Function(\"holder\", \"                                      \\n\\\n            'use strict';                                                    \\n\\\n            var callback = holder.fn;                                        \\n\\\n            return callback(values);                                         \\n\\\n            \".replace(/values/g, values.join(\", \")));\n    };\n    var thenCallbacks = [];\n    var callers = [undefined];\n    for (var i = 1; i <= 5; ++i) {\n        thenCallbacks.push(thenCallback(i));\n        callers.push(caller(i));\n    }\n\n    var Holder = function(total, fn) {\n        this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;\n        this.fn = fn;\n        this.total = total;\n        this.now = 0;\n    };\n\n    Holder.prototype.callers = callers;\n    Holder.prototype.checkFulfillment = function(promise) {\n        var now = this.now;\n        now++;\n        var total = this.total;\n        if (now >= total) {\n            var handler = this.callers[total];\n            promise._pushContext();\n            var ret = tryCatch(handler)(this);\n            promise._popContext();\n            if (ret === errorObj) {\n                promise._rejectCallback(ret.e, false, true);\n            } else {\n                promise._resolveCallback(ret);\n            }\n        } else {\n            this.now = now;\n        }\n    };\n\n    var reject = function (reason) {\n        this._reject(reason);\n    };\n}\n}\n\nPromise.join = function () {\n    var last = arguments.length - 1;\n    var fn;\n    if (last > 0 && typeof arguments[last] === \"function\") {\n        fn = arguments[last];\n        if (!false) {\n            if (last < 6 && canEvaluate) {\n                var ret = new Promise(INTERNAL);\n                ret._captureStackTrace();\n                var holder = new Holder(last, fn);\n                var callbacks = thenCallbacks;\n                for (var i = 0; i < last; ++i) {\n                    var maybePromise = tryConvertToPromise(arguments[i], ret);\n                    if (maybePromise instanceof Promise) {\n                        maybePromise = maybePromise._target();\n                        if (maybePromise._isPending()) {\n                            maybePromise._then(callbacks[i], reject,\n                                               undefined, ret, holder);\n                        } else if (maybePromise._isFulfilled()) {\n                            callbacks[i].call(ret,\n                                              maybePromise._value(), holder);\n                        } else {\n                            ret._reject(maybePromise._reason());\n                        }\n                    } else {\n                        callbacks[i].call(ret, maybePromise, holder);\n                    }\n                }\n                return ret;\n            }\n        }\n    }\n    var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}\n    if (fn) args.pop();\n    var ret = new PromiseArray(args).promise();\n    return fn !== undefined ? ret.spread(fn) : ret;\n};\n\n};\n"]}