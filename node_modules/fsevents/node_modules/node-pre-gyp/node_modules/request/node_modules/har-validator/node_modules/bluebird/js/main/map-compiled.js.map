{"version":3,"sources":["map.js"],"names":[],"mappings":"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","file":"map-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise,\n                          PromiseArray,\n                          apiRejection,\n                          tryConvertToPromise,\n                          INTERNAL) {\nvar getDomain = Promise._getDomain;\nvar async = require(\"./async.js\");\nvar util = require(\"./util.js\");\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar PENDING = {};\nvar EMPTY_ARRAY = [];\n\nfunction MappingPromiseArray(promises, fn, limit, _filter) {\n    this.constructor$(promises);\n    this._promise._captureStackTrace();\n    var domain = getDomain();\n    this._callback = domain === null ? fn : domain.bind(fn);\n    this._preservedValues = _filter === INTERNAL\n        ? new Array(this.length())\n        : null;\n    this._limit = limit;\n    this._inFlight = 0;\n    this._queue = limit >= 1 ? [] : EMPTY_ARRAY;\n    async.invoke(init, this, undefined);\n}\nutil.inherits(MappingPromiseArray, PromiseArray);\nfunction init() {this._init$(undefined, -2);}\n\nMappingPromiseArray.prototype._init = function () {};\n\nMappingPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    var values = this._values;\n    var length = this.length();\n    var preservedValues = this._preservedValues;\n    var limit = this._limit;\n    if (values[index] === PENDING) {\n        values[index] = value;\n        if (limit >= 1) {\n            this._inFlight--;\n            this._drainQueue();\n            if (this._isResolved()) return;\n        }\n    } else {\n        if (limit >= 1 && this._inFlight >= limit) {\n            values[index] = value;\n            this._queue.push(index);\n            return;\n        }\n        if (preservedValues !== null) preservedValues[index] = value;\n\n        var callback = this._callback;\n        var receiver = this._promise._boundValue();\n        this._promise._pushContext();\n        var ret = tryCatch(callback).call(receiver, value, index, length);\n        this._promise._popContext();\n        if (ret === errorObj) return this._reject(ret.e);\n\n        var maybePromise = tryConvertToPromise(ret, this._promise);\n        if (maybePromise instanceof Promise) {\n            maybePromise = maybePromise._target();\n            if (maybePromise._isPending()) {\n                if (limit >= 1) this._inFlight++;\n                values[index] = PENDING;\n                return maybePromise._proxyPromiseArray(this, index);\n            } else if (maybePromise._isFulfilled()) {\n                ret = maybePromise._value();\n            } else {\n                return this._reject(maybePromise._reason());\n            }\n        }\n        values[index] = ret;\n    }\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= length) {\n        if (preservedValues !== null) {\n            this._filter(values, preservedValues);\n        } else {\n            this._resolve(values);\n        }\n\n    }\n};\n\nMappingPromiseArray.prototype._drainQueue = function () {\n    var queue = this._queue;\n    var limit = this._limit;\n    var values = this._values;\n    while (queue.length > 0 && this._inFlight < limit) {\n        if (this._isResolved()) return;\n        var index = queue.pop();\n        this._promiseFulfilled(values[index], index);\n    }\n};\n\nMappingPromiseArray.prototype._filter = function (booleans, values) {\n    var len = values.length;\n    var ret = new Array(len);\n    var j = 0;\n    for (var i = 0; i < len; ++i) {\n        if (booleans[i]) ret[j++] = values[i];\n    }\n    ret.length = j;\n    this._resolve(ret);\n};\n\nMappingPromiseArray.prototype.preservedValues = function () {\n    return this._preservedValues;\n};\n\nfunction map(promises, fn, options, _filter) {\n    var limit = typeof options === \"object\" && options !== null\n        ? options.concurrency\n        : 0;\n    limit = typeof limit === \"number\" &&\n        isFinite(limit) && limit >= 1 ? limit : 0;\n    return new MappingPromiseArray(promises, fn, limit, _filter);\n}\n\nPromise.prototype.map = function (fn, options) {\n    if (typeof fn !== \"function\") return apiRejection(\"fn must be a function\\u000a\\u000a    See http://goo.gl/916lJJ\\u000a\");\n\n    return map(this, fn, options, null).promise();\n};\n\nPromise.map = function (promises, fn, options, _filter) {\n    if (typeof fn !== \"function\") return apiRejection(\"fn must be a function\\u000a\\u000a    See http://goo.gl/916lJJ\\u000a\");\n    return map(promises, fn, options, _filter).promise();\n};\n\n\n};\n"]}