{"version":3,"sources":["promisify.js"],"names":[],"mappings":"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","file":"promisify-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar THIS = {};\nvar util = require(\"./util.js\");\nvar nodebackForPromise = require(\"./promise_resolver.js\")\n    ._nodebackForPromise;\nvar withAppended = util.withAppended;\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar canEvaluate = util.canEvaluate;\nvar TypeError = require(\"./errors\").TypeError;\nvar defaultSuffix = \"Async\";\nvar defaultPromisified = {__isPromisified__: true};\nvar noCopyProps = [\n    \"arity\",    \"length\",\n    \"name\",\n    \"arguments\",\n    \"caller\",\n    \"callee\",\n    \"prototype\",\n    \"__isPromisified__\"\n];\nvar noCopyPropsPattern = new RegExp(\"^(?:\" + noCopyProps.join(\"|\") + \")$\");\n\nvar defaultFilter = function(name) {\n    return util.isIdentifier(name) &&\n        name.charAt(0) !== \"_\" &&\n        name !== \"constructor\";\n};\n\nfunction propsFilter(key) {\n    return !noCopyPropsPattern.test(key);\n}\n\nfunction isPromisified(fn) {\n    try {\n        return fn.__isPromisified__ === true;\n    }\n    catch (e) {\n        return false;\n    }\n}\n\nfunction hasPromisified(obj, key, suffix) {\n    var val = util.getDataPropertyOrDefault(obj, key + suffix,\n                                            defaultPromisified);\n    return val ? isPromisified(val) : false;\n}\nfunction checkValid(ret, suffix, suffixRegexp) {\n    for (var i = 0; i < ret.length; i += 2) {\n        var key = ret[i];\n        if (suffixRegexp.test(key)) {\n            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, \"\");\n            for (var j = 0; j < ret.length; j += 2) {\n                if (ret[j] === keyWithoutAsyncSuffix) {\n                    throw new TypeError(\"Cannot promisify an API that has normal methods with '%s'-suffix\\u000a\\u000a    See http://goo.gl/iWrZbw\\u000a\"\n                        .replace(\"%s\", suffix));\n                }\n            }\n        }\n    }\n}\n\nfunction promisifiableMethods(obj, suffix, suffixRegexp, filter) {\n    var keys = util.inheritedDataKeys(obj);\n    var ret = [];\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var value = obj[key];\n        var passesDefaultFilter = filter === defaultFilter\n            ? true : defaultFilter(key, value, obj);\n        if (typeof value === \"function\" &&\n            !isPromisified(value) &&\n            !hasPromisified(obj, key, suffix) &&\n            filter(key, value, obj, passesDefaultFilter)) {\n            ret.push(key, value);\n        }\n    }\n    checkValid(ret, suffix, suffixRegexp);\n    return ret;\n}\n\nvar escapeIdentRegex = function(str) {\n    return str.replace(/([$])/, \"\\\\$\");\n};\n\nvar makeNodePromisifiedEval;\nif (!false) {\nvar switchCaseArgumentOrder = function(likelyArgumentCount) {\n    var ret = [likelyArgumentCount];\n    var min = Math.max(0, likelyArgumentCount - 1 - 3);\n    for(var i = likelyArgumentCount - 1; i >= min; --i) {\n        ret.push(i);\n    }\n    for(var i = likelyArgumentCount + 1; i <= 3; ++i) {\n        ret.push(i);\n    }\n    return ret;\n};\n\nvar argumentSequence = function(argumentCount) {\n    return util.filledRange(argumentCount, \"_arg\", \"\");\n};\n\nvar parameterDeclaration = function(parameterCount) {\n    return util.filledRange(\n        Math.max(parameterCount, 3), \"_arg\", \"\");\n};\n\nvar parameterCount = function(fn) {\n    if (typeof fn.length === \"number\") {\n        return Math.max(Math.min(fn.length, 1023 + 1), 0);\n    }\n    return 0;\n};\n\nmakeNodePromisifiedEval =\nfunction(callback, receiver, originalName, fn) {\n    var newParameterCount = Math.max(0, parameterCount(fn) - 1);\n    var argumentOrder = switchCaseArgumentOrder(newParameterCount);\n    var shouldProxyThis = typeof callback === \"string\" || receiver === THIS;\n\n    function generateCallForArgumentCount(count) {\n        var args = argumentSequence(count).join(\", \");\n        var comma = count > 0 ? \", \" : \"\";\n        var ret;\n        if (shouldProxyThis) {\n            ret = \"ret = callback.call(this, {{args}}, nodeback); break;\\n\";\n        } else {\n            ret = receiver === undefined\n                ? \"ret = callback({{args}}, nodeback); break;\\n\"\n                : \"ret = callback.call(receiver, {{args}}, nodeback); break;\\n\";\n        }\n        return ret.replace(\"{{args}}\", args).replace(\", \", comma);\n    }\n\n    function generateArgumentSwitchCase() {\n        var ret = \"\";\n        for (var i = 0; i < argumentOrder.length; ++i) {\n            ret += \"case \" + argumentOrder[i] +\":\" +\n                generateCallForArgumentCount(argumentOrder[i]);\n        }\n\n        ret += \"                                                             \\n\\\n        default:                                                             \\n\\\n            var args = new Array(len + 1);                                   \\n\\\n            var i = 0;                                                       \\n\\\n            for (var i = 0; i < len; ++i) {                                  \\n\\\n               args[i] = arguments[i];                                       \\n\\\n            }                                                                \\n\\\n            args[i] = nodeback;                                              \\n\\\n            [CodeForCall]                                                    \\n\\\n            break;                                                           \\n\\\n        \".replace(\"[CodeForCall]\", (shouldProxyThis\n                                ? \"ret = callback.apply(this, args);\\n\"\n                                : \"ret = callback.apply(receiver, args);\\n\"));\n        return ret;\n    }\n\n    var getFunctionCode = typeof callback === \"string\"\n                                ? (\"this != null ? this['\"+callback+\"'] : fn\")\n                                : \"fn\";\n\n    return new Function(\"Promise\",\n                        \"fn\",\n                        \"receiver\",\n                        \"withAppended\",\n                        \"maybeWrapAsError\",\n                        \"nodebackForPromise\",\n                        \"tryCatch\",\n                        \"errorObj\",\n                        \"notEnumerableProp\",\n                        \"INTERNAL\",\"'use strict';                            \\n\\\n        var ret = function (Parameters) {                                    \\n\\\n            'use strict';                                                    \\n\\\n            var len = arguments.length;                                      \\n\\\n            var promise = new Promise(INTERNAL);                             \\n\\\n            promise._captureStackTrace();                                    \\n\\\n            var nodeback = nodebackForPromise(promise);                      \\n\\\n            var ret;                                                         \\n\\\n            var callback = tryCatch([GetFunctionCode]);                      \\n\\\n            switch(len) {                                                    \\n\\\n                [CodeForSwitchCase]                                          \\n\\\n            }                                                                \\n\\\n            if (ret === errorObj) {                                          \\n\\\n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\\n\\\n            }                                                                \\n\\\n            return promise;                                                  \\n\\\n        };                                                                   \\n\\\n        notEnumerableProp(ret, '__isPromisified__', true);                   \\n\\\n        return ret;                                                          \\n\\\n        \"\n        .replace(\"Parameters\", parameterDeclaration(newParameterCount))\n        .replace(\"[CodeForSwitchCase]\", generateArgumentSwitchCase())\n        .replace(\"[GetFunctionCode]\", getFunctionCode))(\n            Promise,\n            fn,\n            receiver,\n            withAppended,\n            maybeWrapAsError,\n            nodebackForPromise,\n            util.tryCatch,\n            util.errorObj,\n            util.notEnumerableProp,\n            INTERNAL\n        );\n};\n}\n\nfunction makeNodePromisifiedClosure(callback, receiver, _, fn) {\n    var defaultThis = (function() {return this;})();\n    var method = callback;\n    if (typeof method === \"string\") {\n        callback = fn;\n    }\n    function promisified() {\n        var _receiver = receiver;\n        if (receiver === THIS) _receiver = this;\n        var promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n        var cb = typeof method === \"string\" && this !== defaultThis\n            ? this[method] : callback;\n        var fn = nodebackForPromise(promise);\n        try {\n            cb.apply(_receiver, withAppended(arguments, fn));\n        } catch(e) {\n            promise._rejectCallback(maybeWrapAsError(e), true, true);\n        }\n        return promise;\n    }\n    util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n    return promisified;\n}\n\nvar makeNodePromisified = canEvaluate\n    ? makeNodePromisifiedEval\n    : makeNodePromisifiedClosure;\n\nfunction promisifyAll(obj, suffix, filter, promisifier) {\n    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + \"$\");\n    var methods =\n        promisifiableMethods(obj, suffix, suffixRegexp, filter);\n\n    for (var i = 0, len = methods.length; i < len; i+= 2) {\n        var key = methods[i];\n        var fn = methods[i+1];\n        var promisifiedKey = key + suffix;\n        if (promisifier === makeNodePromisified) {\n            obj[promisifiedKey] =\n                makeNodePromisified(key, THIS, key, fn, suffix);\n        } else {\n            var promisified = promisifier(fn, function() {\n                return makeNodePromisified(key, THIS, key, fn, suffix);\n            });\n            util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n            obj[promisifiedKey] = promisified;\n        }\n    }\n    util.toFastProperties(obj);\n    return obj;\n}\n\nfunction promisify(callback, receiver) {\n    return makeNodePromisified(callback, receiver, undefined, callback);\n}\n\nPromise.promisify = function (fn, receiver) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"fn must be a function\\u000a\\u000a    See http://goo.gl/916lJJ\\u000a\");\n    }\n    if (isPromisified(fn)) {\n        return fn;\n    }\n    var ret = promisify(fn, arguments.length < 2 ? THIS : receiver);\n    util.copyDescriptors(fn, ret, propsFilter);\n    return ret;\n};\n\nPromise.promisifyAll = function (target, options) {\n    if (typeof target !== \"function\" && typeof target !== \"object\") {\n        throw new TypeError(\"the target of promisifyAll must be an object or a function\\u000a\\u000a    See http://goo.gl/9ITlV0\\u000a\");\n    }\n    options = Object(options);\n    var suffix = options.suffix;\n    if (typeof suffix !== \"string\") suffix = defaultSuffix;\n    var filter = options.filter;\n    if (typeof filter !== \"function\") filter = defaultFilter;\n    var promisifier = options.promisifier;\n    if (typeof promisifier !== \"function\") promisifier = makeNodePromisified;\n\n    if (!util.isIdentifier(suffix)) {\n        throw new RangeError(\"suffix must be a valid identifier\\u000a\\u000a    See http://goo.gl/8FZo5V\\u000a\");\n    }\n\n    var keys = util.inheritedDataKeys(target);\n    for (var i = 0; i < keys.length; ++i) {\n        var value = target[keys[i]];\n        if (keys[i] !== \"constructor\" &&\n            util.isClass(value)) {\n            promisifyAll(value.prototype, suffix, filter, promisifier);\n            promisifyAll(value, suffix, filter, promisifier);\n        }\n    }\n\n    return promisifyAll(target, suffix, filter, promisifier);\n};\n};\n\n"]}