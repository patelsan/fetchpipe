{"version":3,"sources":["thenables.js"],"names":[],"mappings":"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","file":"thenables-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar util = require(\"./util.js\");\nvar errorObj = util.errorObj;\nvar isObject = util.isObject;\n\nfunction tryConvertToPromise(obj, context) {\n    if (isObject(obj)) {\n        if (obj instanceof Promise) {\n            return obj;\n        }\n        else if (isAnyBluebirdPromise(obj)) {\n            var ret = new Promise(INTERNAL);\n            obj._then(\n                ret._fulfillUnchecked,\n                ret._rejectUncheckedCheckError,\n                ret._progressUnchecked,\n                ret,\n                null\n            );\n            return ret;\n        }\n        var then = util.tryCatch(getThen)(obj);\n        if (then === errorObj) {\n            if (context) context._pushContext();\n            var ret = Promise.reject(then.e);\n            if (context) context._popContext();\n            return ret;\n        } else if (typeof then === \"function\") {\n            return doThenable(obj, then, context);\n        }\n    }\n    return obj;\n}\n\nfunction getThen(obj) {\n    return obj.then;\n}\n\nvar hasProp = {}.hasOwnProperty;\nfunction isAnyBluebirdPromise(obj) {\n    return hasProp.call(obj, \"_promise0\");\n}\n\nfunction doThenable(x, then, context) {\n    var promise = new Promise(INTERNAL);\n    var ret = promise;\n    if (context) context._pushContext();\n    promise._captureStackTrace();\n    if (context) context._popContext();\n    var synchronous = true;\n    var result = util.tryCatch(then).call(x,\n                                        resolveFromThenable,\n                                        rejectFromThenable,\n                                        progressFromThenable);\n    synchronous = false;\n    if (promise && result === errorObj) {\n        promise._rejectCallback(result.e, true, true);\n        promise = null;\n    }\n\n    function resolveFromThenable(value) {\n        if (!promise) return;\n        promise._resolveCallback(value);\n        promise = null;\n    }\n\n    function rejectFromThenable(reason) {\n        if (!promise) return;\n        promise._rejectCallback(reason, synchronous, true);\n        promise = null;\n    }\n\n    function progressFromThenable(value) {\n        if (!promise) return;\n        if (typeof promise._progress === \"function\") {\n            promise._progress(value);\n        }\n    }\n    return ret;\n}\n\nreturn tryConvertToPromise;\n};\n"]}