{"version":3,"sources":["crypto.js"],"names":[],"mappings":"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","file":"crypto-compiled.js","sourcesContent":["// Load modules\n\nvar Crypto = require('crypto');\nvar Url = require('url');\nvar Utils = require('./utils');\n\n\n// Declare internals\n\nvar internals = {};\n\n\n// MAC normalization format version\n\nexports.headerVersion = '1';                        // Prevent comparison of mac values generated with different normalized string formats\n\n\n// Supported HMAC algorithms\n\nexports.algorithms = ['sha1', 'sha256'];\n\n\n// Calculate the request MAC\n\n/*\n    type: 'header',                                 // 'header', 'bewit', 'response'\n    credentials: {\n        key: 'aoijedoaijsdlaksjdl',\n        algorithm: 'sha256'                         // 'sha1', 'sha256'\n    },\n    options: {\n        method: 'GET',\n        resource: '/resource?a=1&b=2',\n        host: 'example.com',\n        port: 8080,\n        ts: 1357718381034,\n        nonce: 'd3d345f',\n        hash: 'U4MKKSmiVxk37JCCrAVIjV/OhB3y+NdwoCr6RShbVkE=',\n        ext: 'app-specific-data',\n        app: 'hf48hd83qwkj',                        // Application id (Oz)\n        dlg: 'd8djwekds9cj'                         // Delegated by application id (Oz), requires options.app\n    }\n*/\n\nexports.calculateMac = function (type, credentials, options) {\n\n    var normalized = exports.generateNormalizedString(type, options);\n\n    var hmac = Crypto.createHmac(credentials.algorithm, credentials.key).update(normalized);\n    var digest = hmac.digest('base64');\n    return digest;\n};\n\n\nexports.generateNormalizedString = function (type, options) {\n\n    var resource = options.resource || '';\n    if (resource &&\n        resource[0] !== '/') {\n\n        var url = Url.parse(resource, false);\n        resource = url.path;                        // Includes query\n    }\n\n    var normalized = 'hawk.' + exports.headerVersion + '.' + type + '\\n' +\n                     options.ts + '\\n' +\n                     options.nonce + '\\n' +\n                     (options.method || '').toUpperCase() + '\\n' +\n                     resource + '\\n' +\n                     options.host.toLowerCase() + '\\n' +\n                     options.port + '\\n' +\n                     (options.hash || '') + '\\n';\n\n    if (options.ext) {\n        normalized += options.ext.replace('\\\\', '\\\\\\\\').replace('\\n', '\\\\n');\n    }\n\n    normalized += '\\n';\n\n    if (options.app) {\n        normalized += options.app + '\\n' +\n                      (options.dlg || '') + '\\n';\n    }\n\n    return normalized;\n};\n\n\nexports.calculatePayloadHash = function (payload, algorithm, contentType) {\n\n    var hash = exports.initializePayloadHash(algorithm, contentType);\n    hash.update(payload || '');\n    return exports.finalizePayloadHash(hash);\n};\n\n\nexports.initializePayloadHash = function (algorithm, contentType) {\n\n    var hash = Crypto.createHash(algorithm);\n    hash.update('hawk.' + exports.headerVersion + '.payload\\n');\n    hash.update(Utils.parseContentType(contentType) + '\\n');\n    return hash;\n};\n\n\nexports.finalizePayloadHash = function (hash) {\n\n    hash.update('\\n');\n    return hash.digest('base64');\n};\n\n\nexports.calculateTsMac = function (ts, credentials) {\n\n    var hmac = Crypto.createHmac(credentials.algorithm, credentials.key);\n    hmac.update('hawk.' + exports.headerVersion + '.ts\\n' + ts + '\\n');\n    return hmac.digest('base64');\n};\n\n\nexports.timestampMessage = function (credentials, localtimeOffsetMsec) {\n\n    var now = Utils.nowSecs(localtimeOffsetMsec);\n    var tsm = exports.calculateTsMac(now, credentials);\n    return { ts: now, tsm: tsm };\n};\n"]}