{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["// Load modules\n\nvar Code = require('code');\nvar Hawk = require('../lib');\nvar Lab = require('lab');\nvar Package = require('../package.json');\n\n\n// Declare internals\n\nvar internals = {};\n\n\n// Test shortcuts\n\nvar lab = exports.lab = Lab.script();\nvar describe = lab.experiment;\nvar it = lab.test;\nvar expect = Code.expect;\n\n\ndescribe('Utils', function () {\n\n    describe('parseHost()', function () {\n\n        it('returns port 80 for non tls node request', function (done) {\n\n            var req = {\n                method: 'POST',\n                url: '/resource/4?filter=a',\n                headers: {\n                    host: 'example.com',\n                    'content-type': 'text/plain;x=y'\n                }\n            };\n\n            expect(Hawk.utils.parseHost(req, 'Host').port).to.equal(80);\n            done();\n        });\n\n        it('returns port 443 for non tls node request', function (done) {\n\n            var req = {\n                method: 'POST',\n                url: '/resource/4?filter=a',\n                headers: {\n                    host: 'example.com',\n                    'content-type': 'text/plain;x=y'\n                },\n                connection: {\n                    encrypted: true\n                }\n            };\n\n            expect(Hawk.utils.parseHost(req, 'Host').port).to.equal(443);\n            done();\n        });\n\n        it('returns port 443 for non tls node request (IPv6)', function (done) {\n\n            var req = {\n                method: 'POST',\n                url: '/resource/4?filter=a',\n                headers: {\n                    host: '[123:123:123]',\n                    'content-type': 'text/plain;x=y'\n                },\n                connection: {\n                    encrypted: true\n                }\n            };\n\n            expect(Hawk.utils.parseHost(req, 'Host').port).to.equal(443);\n            done();\n        });\n\n        it('parses IPv6 headers', function (done) {\n\n            var req = {\n                method: 'POST',\n                url: '/resource/4?filter=a',\n                headers: {\n                    host: '[123:123:123]:8000',\n                    'content-type': 'text/plain;x=y'\n                },\n                connection: {\n                    encrypted: true\n                }\n            };\n\n            var host = Hawk.utils.parseHost(req, 'Host');\n            expect(host.port).to.equal('8000');\n            expect(host.name).to.equal('[123:123:123]');\n            done();\n        });\n    });\n\n    describe('version()', function () {\n\n        it('returns the correct package version number', function (done) {\n\n            expect(Hawk.utils.version()).to.equal(Package.version);\n            done();\n        });\n    });\n\n    describe('unauthorized()', function () {\n\n        it('returns a hawk 401', function (done) {\n\n            expect(Hawk.utils.unauthorized('kaboom').output.headers['WWW-Authenticate']).to.equal('Hawk error=\"kaboom\"');\n            done();\n        });\n\n        it('supports attributes', function (done) {\n\n            expect(Hawk.utils.unauthorized('kaboom', { a: 'b' }).output.headers['WWW-Authenticate']).to.equal('Hawk a=\"b\", error=\"kaboom\"');\n            done();\n        });\n    });\n});\n"]}