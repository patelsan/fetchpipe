{"version":3,"sources":["polyfills.js"],"names":[],"mappings":"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","file":"polyfills-compiled.js","sourcesContent":["var fs = require('./fs.js')\nvar constants = require('constants')\n\nvar origCwd = process.cwd\nvar cwd = null\nprocess.cwd = function() {\n  if (!cwd)\n    cwd = origCwd.call(process)\n  return cwd\n}\nvar chdir = process.chdir\nprocess.chdir = function(d) {\n  cwd = null\n  chdir.call(process, d)\n}\n\n// (re-)implement some things that are known busted or missing.\n\n// lchmod, broken prior to 0.6.2\n// back-port the fix here.\nif (constants.hasOwnProperty('O_SYMLINK') &&\n    process.version.match(/^v0\\.6\\.[0-2]|^v0\\.5\\./)) {\n  fs.lchmod = function (path, mode, callback) {\n    callback = callback || noop\n    fs.open( path\n           , constants.O_WRONLY | constants.O_SYMLINK\n           , mode\n           , function (err, fd) {\n      if (err) {\n        callback(err)\n        return\n      }\n      // prefer to return the chmod error, if one occurs,\n      // but still try to close, and report closing errors if they occur.\n      fs.fchmod(fd, mode, function (err) {\n        fs.close(fd, function(err2) {\n          callback(err || err2)\n        })\n      })\n    })\n  }\n\n  fs.lchmodSync = function (path, mode) {\n    var fd = fs.openSync(path, constants.O_WRONLY | constants.O_SYMLINK, mode)\n\n    // prefer to return the chmod error, if one occurs,\n    // but still try to close, and report closing errors if they occur.\n    var err, err2\n    try {\n      var ret = fs.fchmodSync(fd, mode)\n    } catch (er) {\n      err = er\n    }\n    try {\n      fs.closeSync(fd)\n    } catch (er) {\n      err2 = er\n    }\n    if (err || err2) throw (err || err2)\n    return ret\n  }\n}\n\n\n// lutimes implementation, or no-op\nif (!fs.lutimes) {\n  if (constants.hasOwnProperty(\"O_SYMLINK\")) {\n    fs.lutimes = function (path, at, mt, cb) {\n      fs.open(path, constants.O_SYMLINK, function (er, fd) {\n        cb = cb || noop\n        if (er) return cb(er)\n        fs.futimes(fd, at, mt, function (er) {\n          fs.close(fd, function (er2) {\n            return cb(er || er2)\n          })\n        })\n      })\n    }\n\n    fs.lutimesSync = function (path, at, mt) {\n      var fd = fs.openSync(path, constants.O_SYMLINK)\n        , err\n        , err2\n        , ret\n\n      try {\n        var ret = fs.futimesSync(fd, at, mt)\n      } catch (er) {\n        err = er\n      }\n      try {\n        fs.closeSync(fd)\n      } catch (er) {\n        err2 = er\n      }\n      if (err || err2) throw (err || err2)\n      return ret\n    }\n\n  } else if (fs.utimensat && constants.hasOwnProperty(\"AT_SYMLINK_NOFOLLOW\")) {\n    // maybe utimensat will be bound soonish?\n    fs.lutimes = function (path, at, mt, cb) {\n      fs.utimensat(path, at, mt, constants.AT_SYMLINK_NOFOLLOW, cb)\n    }\n\n    fs.lutimesSync = function (path, at, mt) {\n      return fs.utimensatSync(path, at, mt, constants.AT_SYMLINK_NOFOLLOW)\n    }\n\n  } else {\n    fs.lutimes = function (_a, _b, _c, cb) { process.nextTick(cb) }\n    fs.lutimesSync = function () {}\n  }\n}\n\n\n// https://github.com/isaacs/node-graceful-fs/issues/4\n// Chown should not fail on einval or eperm if non-root.\n// It should not fail on enosys ever, as this just indicates\n// that a fs doesn't support the intended operation.\n\nfs.chown = chownFix(fs.chown)\nfs.fchown = chownFix(fs.fchown)\nfs.lchown = chownFix(fs.lchown)\n\nfs.chmod = chownFix(fs.chmod)\nfs.fchmod = chownFix(fs.fchmod)\nfs.lchmod = chownFix(fs.lchmod)\n\nfs.chownSync = chownFixSync(fs.chownSync)\nfs.fchownSync = chownFixSync(fs.fchownSync)\nfs.lchownSync = chownFixSync(fs.lchownSync)\n\nfs.chmodSync = chownFix(fs.chmodSync)\nfs.fchmodSync = chownFix(fs.fchmodSync)\nfs.lchmodSync = chownFix(fs.lchmodSync)\n\nfunction chownFix (orig) {\n  if (!orig) return orig\n  return function (target, uid, gid, cb) {\n    return orig.call(fs, target, uid, gid, function (er, res) {\n      if (chownErOk(er)) er = null\n      cb(er, res)\n    })\n  }\n}\n\nfunction chownFixSync (orig) {\n  if (!orig) return orig\n  return function (target, uid, gid) {\n    try {\n      return orig.call(fs, target, uid, gid)\n    } catch (er) {\n      if (!chownErOk(er)) throw er\n    }\n  }\n}\n\n// ENOSYS means that the fs doesn't support the op. Just ignore\n// that, because it doesn't matter.\n//\n// if there's no getuid, or if getuid() is something other\n// than 0, and the error is EINVAL or EPERM, then just ignore\n// it.\n//\n// This specific case is a silent failure in cp, install, tar,\n// and most other unix tools that manage permissions.\n//\n// When running as root, or if other types of errors are\n// encountered, then it's strict.\nfunction chownErOk (er) {\n  if (!er)\n    return true\n\n  if (er.code === \"ENOSYS\")\n    return true\n\n  var nonroot = !process.getuid || process.getuid() !== 0\n  if (nonroot) {\n    if (er.code === \"EINVAL\" || er.code === \"EPERM\")\n      return true\n  }\n\n  return false\n}\n\n\n// if lchmod/lchown do not exist, then make them no-ops\nif (!fs.lchmod) {\n  fs.lchmod = function (path, mode, cb) {\n    process.nextTick(cb)\n  }\n  fs.lchmodSync = function () {}\n}\nif (!fs.lchown) {\n  fs.lchown = function (path, uid, gid, cb) {\n    process.nextTick(cb)\n  }\n  fs.lchownSync = function () {}\n}\n\n\n\n// on Windows, A/V software can lock the directory, causing this\n// to fail with an EACCES or EPERM if the directory contains newly\n// created files.  Try again on failure, for up to 1 second.\nif (process.platform === \"win32\") {\n  var rename_ = fs.rename\n  fs.rename = function rename (from, to, cb) {\n    var start = Date.now()\n    rename_(from, to, function CB (er) {\n      if (er\n          && (er.code === \"EACCES\" || er.code === \"EPERM\")\n          && Date.now() - start < 1000) {\n        return rename_(from, to, CB)\n      }\n      if(cb) cb(er)\n    })\n  }\n}\n\n\n// if read() returns EAGAIN, then just try it again.\nvar read = fs.read\nfs.read = function (fd, buffer, offset, length, position, callback_) {\n  var callback\n  if (callback_ && typeof callback_ === 'function') {\n    var eagCounter = 0\n    callback = function (er, _, __) {\n      if (er && er.code === 'EAGAIN' && eagCounter < 10) {\n        eagCounter ++\n        return read.call(fs, fd, buffer, offset, length, position, callback)\n      }\n      callback_.apply(this, arguments)\n    }\n  }\n  return read.call(fs, fd, buffer, offset, length, position, callback)\n}\n\nvar readSync = fs.readSync\nfs.readSync = function (fd, buffer, offset, length, position) {\n  var eagCounter = 0\n  while (true) {\n    try {\n      return readSync.call(fs, fd, buffer, offset, length, position)\n    } catch (er) {\n      if (er.code === 'EAGAIN' && eagCounter < 10) {\n        eagCounter ++\n        continue\n      }\n      throw er\n    }\n  }\n}\n\n"]}