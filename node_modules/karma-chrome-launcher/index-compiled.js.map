{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var fsAccess = require('fs-access')\nvar path = require('path')\nvar which = require('which')\n\nfunction isJSFlags (flag) {\n  return flag.indexOf('--js-flags=') === 0\n}\n\nfunction sanitizeJSFlags (flag) {\n  var test = /--js-flags=(['\"])/.exec(flag)\n  if (!test) {\n    return flag\n  }\n  var escapeChar = test[1]\n  var endExp = new RegExp(escapeChar + '$')\n  var startExp = new RegExp('--js-flags=' + escapeChar)\n  return flag.replace(startExp, '--js-flags=').replace(endExp, '')\n}\n\nvar ChromeBrowser = function (baseBrowserDecorator, args) {\n  baseBrowserDecorator(this)\n\n  var flags = args.flags || []\n\n  this._getOptions = function (url) {\n    // Chrome CLI options\n    // http://peter.sh/experiments/chromium-command-line-switches/\n    flags.forEach(function (flag, i) {\n      if (isJSFlags(flag)) {\n        flags[i] = sanitizeJSFlags(flag)\n      }\n    })\n\n    return [\n      '--user-data-dir=' + this._tempDir,\n      '--no-default-browser-check',\n      '--no-first-run',\n      '--disable-default-apps',\n      '--disable-popup-blocking',\n      '--disable-translate'\n    ].concat(flags, [url])\n  }\n}\n\n// Return location of chrome.exe file for a given Chrome directory (available: \"Chrome\", \"Chrome SxS\").\nfunction getChromeExe (chromeDirName) {\n  // Only run these checks on win32\n  if (process.platform !== 'win32') {\n    return null\n  }\n  var windowsChromeDirectory, i, prefix\n  var suffix = '\\\\Google\\\\' + chromeDirName + '\\\\Application\\\\chrome.exe'\n  var prefixes = [process.env.LOCALAPPDATA, process.env.PROGRAMFILES, process.env['PROGRAMFILES(X86)']]\n\n  for (i = 0; i < prefixes.length; i++) {\n    prefix = prefixes[i]\n    try {\n      windowsChromeDirectory = path.join(prefix, suffix)\n      fsAccess.sync(windowsChromeDirectory)\n      return windowsChromeDirectory\n    } catch (e) {}\n  }\n\n  return windowsChromeDirectory\n}\n\nfunction getBin (commands) {\n  // Don't run these checks on win32\n  if (process.platform !== 'linux') {\n    return null\n  }\n  var bin, i\n  for (i = 0; i < commands.length; i++) {\n    try {\n      if (which.sync(commands[i])) {\n        bin = commands[i]\n        break\n      }\n    } catch (e) {}\n  }\n  return bin\n}\n\nfunction getChromeDarwin (defaultPath) {\n  if (process.platform !== 'darwin') {\n    return null\n  }\n\n  try {\n    var homePath = path.join(process.env.HOME, defaultPath)\n    fsAccess.sync(homePath)\n    return homePath\n  } catch (e) {\n    return defaultPath\n  }\n}\n\nChromeBrowser.prototype = {\n  name: 'Chrome',\n\n  DEFAULT_CMD: {\n    // Try chromium-browser before chromium to avoid conflict with the legacy\n    // chromium-bsu package previously known as 'chromium' in Debian and Ubuntu.\n    linux: getBin(['chromium-browser', 'chromium', 'google-chrome', 'google-chrome-stable']),\n    darwin: getChromeDarwin('/Applications/Google Chrome.app/Contents/MacOS/Google Chrome'),\n    win32: getChromeExe('Chrome')\n  },\n  ENV_CMD: 'CHROME_BIN'\n}\n\nChromeBrowser.$inject = ['baseBrowserDecorator', 'args']\n\nfunction canaryGetOptions (url, args, parent) {\n  // disable crankshaft optimizations, as it causes lot of memory leaks (as of Chrome 23.0)\n  var flags = args.flags || []\n  var augmentedFlags\n  var customFlags = '--nocrankshaft --noopt'\n\n  flags.forEach(function (flag) {\n    if (isJSFlags(flag)) {\n      augmentedFlags = sanitizeJSFlags(flag) + ' ' + customFlags\n    }\n  })\n\n  return parent.call(this, url).concat([augmentedFlags || '--js-flags=' + customFlags])\n}\n\nvar ChromeCanaryBrowser = function (baseBrowserDecorator, args) {\n  ChromeBrowser.apply(this, arguments)\n\n  var parentOptions = this._getOptions\n  this._getOptions = function (url) {\n    return canaryGetOptions.call(this, url, args, parentOptions)\n  }\n}\n\nChromeCanaryBrowser.prototype = {\n  name: 'ChromeCanary',\n\n  DEFAULT_CMD: {\n    linux: getBin(['google-chrome-canary', 'google-chrome-unstable']),\n    darwin: getChromeDarwin('/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary'),\n    win32: getChromeExe('Chrome SxS')\n  },\n  ENV_CMD: 'CHROME_CANARY_BIN'\n}\n\nChromeCanaryBrowser.$inject = ['baseBrowserDecorator', 'args']\n\nvar DartiumBrowser = function () {\n  ChromeBrowser.apply(this, arguments)\n\n  var checkedFlag = '--checked'\n  var dartFlags = process.env.DART_FLAGS || ''\n  var flags = dartFlags.split(' ')\n  if (flags.indexOf(checkedFlag) === -1) {\n    flags.push(checkedFlag)\n    process.env.DART_FLAGS = flags.join(' ')\n  }\n}\n\nDartiumBrowser.prototype = {\n  name: 'Dartium',\n  DEFAULT_CMD: {},\n  ENV_CMD: 'DARTIUM_BIN'\n}\n\nDartiumBrowser.$inject = ['baseBrowserDecorator', 'args']\n\n// PUBLISH DI MODULE\nmodule.exports = {\n  'launcher:Chrome': ['type', ChromeBrowser],\n  'launcher:ChromeCanary': ['type', ChromeCanaryBrowser],\n  'launcher:Dartium': ['type', DartiumBrowser]\n}\n\nmodule.exports.test = {\n  isJSFlags: isJSFlags,\n  sanitizeJSFlags: sanitizeJSFlags,\n  canaryGetOptions: canaryGetOptions\n}\n"]}