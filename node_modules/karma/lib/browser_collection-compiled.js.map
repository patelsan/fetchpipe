{"version":3,"sources":["browser_collection.js"],"names":[],"mappings":"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","file":"browser_collection-compiled.js","sourcesContent":["var EXECUTING = require('./browser').STATE_EXECUTING\nvar Result = require('./browser_result')\n\nvar Collection = function (emitter, browsers) {\n  browsers = browsers || []\n\n  this.add = function (browser) {\n    browsers.push(browser)\n    emitter.emit('browsers_change', this)\n  }\n\n  this.remove = function (browser) {\n    var index = browsers.indexOf(browser)\n\n    if (index === -1) {\n      return false\n    }\n\n    browsers.splice(index, 1)\n    emitter.emit('browsers_change', this)\n\n    return true\n  }\n\n  this.getById = function (browserId) {\n    for (var i = 0; i < browsers.length; i++) {\n      if (browsers[i].id === browserId) {\n        return browsers[i]\n      }\n    }\n\n    return null\n  }\n\n  this.setAllToExecuting = function () {\n    browsers.forEach(function (browser) {\n      browser.state = EXECUTING\n    })\n\n    emitter.emit('browsers_change', this)\n  }\n\n  this.areAllReady = function (nonReadyList) {\n    nonReadyList = nonReadyList || []\n\n    browsers.forEach(function (browser) {\n      if (!browser.isReady()) {\n        nonReadyList.push(browser)\n      }\n    })\n\n    return nonReadyList.length === 0\n  }\n\n  this.serialize = function () {\n    return browsers.map(function (browser) {\n      return browser.serialize()\n    })\n  }\n\n  this.getResults = function () {\n    var results = browsers.reduce(function (previous, current) {\n      previous.success += current.lastResult.success\n      previous.failed += current.lastResult.failed\n      previous.error = previous.error || current.lastResult.error\n      previous.disconnected = previous.disconnected || current.lastResult.disconnected\n      return previous\n    }, {success: 0, failed: 0, error: false, disconnected: false, exitCode: 0})\n\n    // compute exit status code\n    results.exitCode = results.failed || results.error || results.disconnected ? 1 : 0\n\n    return results\n  }\n\n  // TODO(vojta): can we remove this? (we clear the results per browser in onBrowserStart)\n  this.clearResults = function () {\n    browsers.forEach(function (browser) {\n      browser.lastResult = new Result()\n    })\n  }\n\n  this.clone = function () {\n    return new Collection(emitter, browsers.slice())\n  }\n\n  // Array APIs\n  this.map = function (callback, context) {\n    return browsers.map(callback, context)\n  }\n\n  this.forEach = function (callback, context) {\n    return browsers.forEach(callback, context)\n  }\n\n  // this.length\n  Object.defineProperty(this, 'length', {\n    get: function () {\n      return browsers.length\n    }\n  })\n}\nCollection.$inject = ['emitter']\n\nmodule.exports = Collection\n"]}