{"version":3,"sources":["events.js"],"names":[],"mappings":"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","file":"events-compiled.js","sourcesContent":["var events = require('events')\nvar util = require('util')\n\nvar helper = require('./helper')\n\nvar bindAllEvents = function (object, context) {\n  context = context || this\n\n  var bindMethod = function (method) {\n    context.on(helper.camelToSnake(method.substr(2)), function () {\n      var args = Array.prototype.slice.call(arguments, 0)\n      args.push(context)\n      object[method].apply(object, args)\n    })\n  }\n\n  for (var method in object) {\n    if (helper.isFunction(object[method]) && method.substr(0, 2) === 'on') {\n      bindMethod(method)\n    }\n  }\n}\n\nvar bufferEvents = function (emitter, eventsToBuffer) {\n  var listeners = []\n  var eventsToReply = []\n  var genericListener = function () {\n    eventsToReply.push(Array.prototype.slice.call(arguments))\n  }\n\n  eventsToBuffer.forEach(function (eventName) {\n    var listener = genericListener.bind(null, eventName)\n    listeners.push(listener)\n    emitter.on(eventName, listener)\n  })\n\n  return function () {\n    if (!eventsToReply) {\n      return\n    }\n\n    // remove all buffering listeners\n    listeners.forEach(function (listener, i) {\n      emitter.removeListener(eventsToBuffer[i], listener)\n    })\n\n    // reply\n    eventsToReply.forEach(function (args) {\n      events.EventEmitter.prototype.emit.apply(emitter, args)\n    })\n\n    // free-up\n    listeners = eventsToReply = null\n  }\n}\n\n// TODO(vojta): log.debug all events\nvar EventEmitter = function () {\n  this.bind = bindAllEvents\n\n  this.emitAsync = function (name) {\n    // TODO(vojta): allow passing args\n    // TODO(vojta): ignore/throw if listener call done() multiple times\n    var pending = this.listeners(name).length\n    var deferred = helper.defer()\n    var done = function () {\n      if (!--pending) {\n        deferred.resolve()\n      }\n    }\n\n    this.emit(name, done)\n\n    if (!pending) {\n      deferred.resolve()\n    }\n\n    return deferred.promise\n  }\n}\n\nutil.inherits(EventEmitter, events.EventEmitter)\n\n// PUBLISH\nexports.EventEmitter = EventEmitter\nexports.bindAll = bindAllEvents\nexports.bufferEvents = bufferEvents\n"]}