{"version":3,"sources":["formatters.js"],"names":[],"mappings":"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","file":"formatters-compiled.js","sourcesContent":["var fs = require('fs')\nvar util = require('util')\n\nvar JS_TEMPLATE_PATH = __dirname + '/../../config.tpl.js'\nvar COFFEE_TEMPLATE_PATH = __dirname + '/../../config.tpl.coffee'\nvar JS_REQUIREJS_TEMPLATE_PATH = __dirname + '/../../requirejs.config.tpl.js'\nvar COFFEE_REQUIREJS_TEMPLATE_PATH = __dirname + '/../../requirejs.config.tpl.coffee'\nvar COFFEE_REGEXP = /\\.coffee$/\nvar LIVE_TEMPLATE_PATH = __dirname + '/../../config.tpl.ls'\nvar LIVE_REGEXP = /\\.ls$/\n\nvar isCoffeeFile = function (filename) {\n  return COFFEE_REGEXP.test(filename)\n}\n\nvar isLiveFile = function (filename) {\n  return LIVE_REGEXP.test(filename)\n}\n\nvar JavaScriptFormatter = function () {\n  var quote = function (value) {\n    return \"'\" + value + \"'\"\n  }\n\n  var quoteNonIncludedPattern = function (value) {\n    return util.format('{pattern: %s, included: false}', quote(value))\n  }\n\n  var pad = function (str, pad) {\n    return str.replace(/\\n/g, '\\n' + pad).replace(/\\s+$/gm, '')\n  }\n\n  var formatQuottedList = function (list) {\n    return list.map(quote).join(', ')\n  }\n\n  this.TEMPLATE_FILE_PATH = JS_TEMPLATE_PATH\n  this.REQUIREJS_TEMPLATE_FILE = JS_REQUIREJS_TEMPLATE_PATH\n\n  this.formatFiles = function (includedFiles, onlyServedFiles) {\n    var files = includedFiles.map(quote)\n\n    onlyServedFiles.forEach(function (onlyServedFile) {\n      files.push(quoteNonIncludedPattern(onlyServedFile))\n    })\n\n    files = files.map(function (file) {\n      return '\\n      ' + file\n    })\n\n    return files.join(',')\n  }\n\n  this.formatPreprocessors = function (preprocessors) {\n    var lines = []\n    Object.keys(preprocessors).forEach(function (pattern) {\n      lines.push('  ' + quote(pattern) + ': [' + formatQuottedList(preprocessors[pattern]) + ']')\n    })\n\n    return pad('{\\n' + lines.join(',\\n') + '\\n}', '    ')\n  }\n\n  this.formatFrameworks = formatQuottedList\n\n  this.formatBrowsers = formatQuottedList\n\n  this.formatAnswers = function (answers) {\n    return {\n      DATE: new Date(),\n      BASE_PATH: answers.basePath,\n      FRAMEWORKS: this.formatFrameworks(answers.frameworks),\n      FILES: this.formatFiles(answers.files, answers.onlyServedFiles),\n      EXCLUDE: this.formatFiles(answers.exclude, []),\n      AUTO_WATCH: answers.autoWatch ? 'true' : 'false',\n      BROWSERS: this.formatBrowsers(answers.browsers),\n      PREPROCESSORS: this.formatPreprocessors(answers.preprocessors)\n    }\n  }\n\n  this.generateConfigFile = function (answers) {\n    var template = fs.readFileSync(this.TEMPLATE_FILE_PATH).toString()\n    var replacements = this.formatAnswers(answers)\n\n    return template.replace(/%(.*)%/g, function (a, key) {\n      return replacements[key]\n    })\n  }\n\n  this.writeConfigFile = function (path, answers) {\n    fs.writeFileSync(path, this.generateConfigFile(answers))\n  }\n\n  this.generateRequirejsConfigFile = function () {\n    var template = fs.readFileSync(this.REQUIREJS_TEMPLATE_FILE).toString()\n    return template\n  }\n\n  this.writeRequirejsConfigFile = function (path) {\n    fs.writeFileSync(path, this.generateRequirejsConfigFile())\n  }\n}\n\nvar CoffeeFormatter = function () {\n  JavaScriptFormatter.call(this)\n\n  this.TEMPLATE_FILE_PATH = COFFEE_TEMPLATE_PATH\n  this.REQUIREJS_TEMPLATE_FILE = COFFEE_REQUIREJS_TEMPLATE_PATH\n}\n\nvar LiveFormatter = function () {\n  JavaScriptFormatter.call(this)\n\n  this.TEMPLATE_FILE_PATH = LIVE_TEMPLATE_PATH\n}\n\nexports.JavaScript = JavaScriptFormatter\nexports.Coffee = CoffeeFormatter\nexports.Live = LiveFormatter\n\nexports.createForPath = function (path) {\n  if (isCoffeeFile(path)) {\n    return new CoffeeFormatter()\n  }\n\n  if (isLiveFile(path)) {\n    return new LiveFormatter()\n  }\n\n  return new JavaScriptFormatter()\n}\n"]}