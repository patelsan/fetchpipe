{"version":3,"sources":["BaseRollingFileStream-test.js"],"names":[],"mappings":"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","file":"BaseRollingFileStream-test-compiled.js","sourcesContent":["\"use strict\";\nvar vows = require('vows')\n, assert = require('assert')\n, fs = require('fs')\n, sandbox = require('sandboxed-module');\n\nvows.describe('../../lib/streams/BaseRollingFileStream').addBatch({\n  'when node version < 0.10.0': {\n    topic: function() {\n      var streamLib = sandbox.load(\n        '../../lib/streams/BaseRollingFileStream',\n        {\n          globals: {\n            process: {\n              version: '0.8.11'\n            }\n          },\n          requires: {\n            'readable-stream': {\n              Writable: function() {}\n            }\n          }\n        }\n      );\n      return streamLib.required;\n    },\n    'it should use readable-stream to maintain compatibility': function(required) {\n      assert.ok(required['readable-stream']);\n      assert.ok(!required.stream);\n    }\n  },\n\n  'when node version > 0.10.0': {\n    topic: function() {\n      var streamLib = sandbox.load(\n        '../../lib/streams/BaseRollingFileStream',\n        {\n          globals: {\n            process: {\n              version: '0.10.1'\n            }\n          },\n          requires: {\n            'stream': {\n              Writable: function() {}\n            }\n          }\n        }\n      );\n      return streamLib.required;\n    },\n    'it should use the core stream module': function(required) {\n      assert.ok(required.stream);\n      assert.ok(!required['readable-stream']);\n    }\n  },\n\n  'when no filename is passed': {\n    topic: require('../../lib/streams/BaseRollingFileStream'),\n    'it should throw an error': function(BaseRollingFileStream) {\n      try {\n        new BaseRollingFileStream();\n        assert.fail('should not get here');\n      } catch (e) {\n        assert.ok(e);\n      }\n    }\n  },\n\n  'default behaviour': {\n    topic: function() {\n      var BaseRollingFileStream = require('../../lib/streams/BaseRollingFileStream')\n      , stream = new BaseRollingFileStream('basetest.log');\n      return stream;\n    },\n    teardown: function() {\n      try {\n        fs.unlink('basetest.log');\n      } catch (e) {\n        console.error(\"could not remove basetest.log\", e);\n      }\n    },\n    'it should not want to roll': function(stream) {\n      assert.isFalse(stream.shouldRoll());\n    },\n    'it should not roll': function(stream) {\n      var cbCalled = false;\n      //just calls the callback straight away, no async calls\n      stream.roll('basetest.log', function() { cbCalled = true; });\n      assert.isTrue(cbCalled);\n    }\n  }\n}).exportTo(module);\n"]}