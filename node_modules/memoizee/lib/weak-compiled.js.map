{"version":3,"sources":["weak.js"],"names":[],"mappings":"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","file":"weak-compiled.js","sourcesContent":["'use strict';\n\nvar customError      = require('es5-ext/error/custom')\n  , defineLength     = require('es5-ext/function/_define-length')\n  , partial          = require('es5-ext/function/#/partial')\n  , copy             = require('es5-ext/object/copy')\n  , normalizeOpts    = require('es5-ext/object/normalize-options')\n  , callable         = require('es5-ext/object/valid-callable')\n  , d                = require('d')\n  , WeakMap          = require('es6-weak-map')\n  , resolveLength    = require('./resolve-length')\n  , extensions       = require('./registered-extensions')\n  , resolveResolve   = require('./resolve-resolve')\n  , resolveNormalize = require('./resolve-normalize')\n\n  , slice = Array.prototype.slice, defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty;\n\nmodule.exports = function (memoize) {\n\treturn function (fn/*, options*/) {\n\t\tvar map, length, options = normalizeOpts(arguments[1]), memoized, resolve, normalizer;\n\n\t\tcallable(fn);\n\n\t\t// Do not memoize already memoized function\n\t\tif (hasOwnProperty.call(fn, '__memoized__') && !options.force) return fn;\n\n\t\tlength = resolveLength(options.length, fn.length, options.async && extensions.async);\n\t\toptions.length = length ? length - 1 : 0;\n\t\tmap = new WeakMap();\n\n\t\tif (options.resolvers) resolve = resolveResolve(options.resolvers);\n\t\tif (options.normalizer) normalizer = resolveNormalize(options.normalizer);\n\n\t\tif ((length === 1) && !normalizer && !(options.async && extensions.async) &&\n\t\t\t\t!(options.dispose && extensions.dispose) && !(options.maxAge && extensions.maxAge) &&\n\t\t\t\t!(options.max && extensions.max) && !(options.refCounter && extensions.refCounter)) {\n\t\t\treturn defineProperties(function (obj) {\n\t\t\t\tvar result;\n\t\t\t\tif (resolve) obj = resolve(arguments)[0];\n\t\t\t\tif (map.has(obj)) return map.get(obj);\n\t\t\t\tresult = fn.call(this, obj);\n\t\t\t\tif (map.has(obj)) throw customError(\"Circular invocation\", 'CIRCULAR_INVOCATION');\n\t\t\t\tmap.set(obj, result);\n\t\t\t\treturn result;\n\t\t\t}, {\n\t\t\t\t__memoized__: d(true),\n\t\t\t\tdelete: d(function (obj) {\n\t\t\t\t\tif (resolve) obj = resolve(arguments)[0];\n\t\t\t\t\treturn map.delete(obj);\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t\tmemoized = defineProperties(defineLength(function (obj) {\n\t\t\tvar memoizer, args = arguments;\n\t\t\tif (resolve) {\n\t\t\t\targs = resolve(args);\n\t\t\t\tobj = args[0];\n\t\t\t}\n\t\t\tmemoizer = map.get(obj);\n\t\t\tif (!memoizer) {\n\t\t\t\tif (normalizer) {\n\t\t\t\t\toptions = copy(options);\n\t\t\t\t\toptions.normalizer = copy(normalizer);\n\t\t\t\t\toptions.normalizer.get = partial.call(options.normalizer.get, obj);\n\t\t\t\t\toptions.normalizer.set = partial.call(options.normalizer.set, obj);\n\t\t\t\t\tif (options.normalizer.delete) {\n\t\t\t\t\t\toptions.normalizer.delete = partial.call(options.normalizer.delete, obj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmap.set(obj, memoizer = memoize(partial.call(fn, obj), options));\n\t\t\t}\n\t\t\treturn memoizer.apply(this, slice.call(args, 1));\n\t\t}, length), {\n\t\t\t__memoized__: d(true),\n\t\t\tdelete: d(defineLength(function (obj) {\n\t\t\t\tvar memoizer, args = arguments;\n\t\t\t\tif (resolve) {\n\t\t\t\t\targs = resolve(args);\n\t\t\t\t\tobj = args[0];\n\t\t\t\t}\n\t\t\t\tmemoizer = map.get(obj);\n\t\t\t\tif (!memoizer) return;\n\t\t\t\tmemoizer.delete.apply(this, slice.call(args, 1));\n\t\t\t}, length))\n\t\t});\n\t\tif (!options.refCounter || !extensions.refCounter) return memoized;\n\t\tdefineProperties(memoized, {\n\t\t\tdeleteRef: d(defineLength(function (obj) {\n\t\t\t\tvar memoizer, args = arguments;\n\t\t\t\tif (resolve) {\n\t\t\t\t\targs = resolve(args);\n\t\t\t\t\tobj = args[0];\n\t\t\t\t}\n\t\t\t\tmemoizer = map.get(obj);\n\t\t\t\tif (!memoizer) return null;\n\t\t\t\treturn memoizer.deleteRef.apply(this, slice.call(args, 1));\n\t\t\t}, length)),\n\t\t\tgetRefCount: d(defineLength(function (obj) {\n\t\t\t\tvar memoizer, args = arguments;\n\t\t\t\tif (resolve) {\n\t\t\t\t\targs = resolve(args);\n\t\t\t\t\tobj = args[0];\n\t\t\t\t}\n\t\t\t\tmemoizer = map.get(obj);\n\t\t\t\tif (!memoizer) return 0;\n\t\t\t\treturn memoizer.getRefCount.apply(this, slice.call(args, 1));\n\t\t\t}, length))\n\t\t});\n\t\treturn memoized;\n\t};\n};\n"]}