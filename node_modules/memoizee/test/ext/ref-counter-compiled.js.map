{"version":3,"sources":["ref-counter.js"],"names":[],"mappings":"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","file":"ref-counter-compiled.js","sourcesContent":["'use strict';\n\nvar memoize  = require('../..')\n  , nextTick = require('next-tick');\n\nmodule.exports = function () {\n\treturn {\n\t\tRegular: function (a) {\n\t\t\tvar i = 0, fn = function (x, y, z) { ++i; return x + y + z; }, mfn;\n\t\t\tmfn = memoize(fn, { refCounter: true });\n\t\t\ta(mfn.deleteRef(3, 5, 7), null, \"Delete before\");\n\t\t\ta(mfn(3, 5, 7), 15, \"Initial\");\n\t\t\ta(mfn(3, 5, 7), 15, \"Cache\");\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #1\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #2\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #3\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(i, 1, \"Not deleteed\");\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #4\");\n\t\t\ta(mfn.deleteRef(3, 5, 7), true, \"Delete final\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(i, 2, \"Restarted\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(i, 2, \"Cached again\");\n\t\t},\n\t\t\"Regular: Async\": function (a, d) {\n\t\t\tvar mfn, fn, u = {}, i = 0;\n\t\t\tfn = function (x, y, cb) {\n\t\t\t\tnextTick(function () {\n\t\t\t\t\t++i;\n\t\t\t\t\tcb(null, x + y);\n\t\t\t\t});\n\t\t\t\treturn u;\n\t\t\t};\n\n\t\t\tmfn = memoize(fn, { async: true, refCounter: true });\n\n\t\t\ta(mfn.deleteRef(3, 7), null, \"Delete ref before\");\n\n\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 10], \"Result #1\");\n\t\t\t}), u, \"Initial\");\n\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 10], \"Result #2\");\n\t\t\t}), u, \"Initial #2\");\n\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 13], \"Result B #1\");\n\t\t\t}), u, \"Initial #2\");\n\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 10], \"Result #3\");\n\t\t\t}), u, \"Initial #2\");\n\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 13], \"Result B #2\");\n\t\t\t}), u, \"Initial #3\");\n\n\t\t\tnextTick(function () {\n\t\t\t\ta(i, 2, \"Called #2\");\n\n\t\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\t\ta.deep([err, res], [null, 10], \"Again: Result\");\n\t\t\t\t}), u, \"Again: Initial\");\n\t\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\t\ta.deep([err, res], [null, 13], \"Again B: Result\");\n\t\t\t\t}), u, \"Again B: Initial\");\n\n\t\t\t\tnextTick(function () {\n\t\t\t\t\ta(i, 2, \"Again Called #2\");\n\n\t\t\t\t\ta(mfn.deleteRef(3, 7), false, \"Delete ref #1\");\n\t\t\t\t\ta(mfn.deleteRef(3, 7), false, \"Delete ref #2\");\n\t\t\t\t\ta(mfn.deleteRef(3, 7), false, \"Delete ref #3\");\n\t\t\t\t\ta(mfn.deleteRef(3, 7), true, \"Delete ref Final\");\n\n\t\t\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\t\t\ta.deep([err, res], [null, 10], \"Again: Result\");\n\t\t\t\t\t}), u, \"Again: Initial\");\n\t\t\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\t\t\ta.deep([err, res], [null, 13], \"Again B: Result\");\n\t\t\t\t\t}), u, \"Again B: Initial\");\n\n\t\t\t\t\tnextTick(function () {\n\t\t\t\t\t\ta(i, 3, \"Call After delete\");\n\t\t\t\t\t\td();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tPrimitive: function (a) {\n\t\t\tvar i = 0, fn = function (x, y, z) { ++i; return x + y + z; }, mfn;\n\t\t\tmfn = memoize(fn, { primitive: true, refCounter: true });\n\t\t\ta(mfn.deleteRef(3, 5, 7), null, \"Delete before\");\n\t\t\ta(mfn(3, 5, 7), 15, \"Initial\");\n\t\t\ta(mfn(3, 5, 7), 15, \"Cache\");\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #1\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #2\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #3\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(i, 1, \"Not deleteed\");\n\t\t\ta(mfn.deleteRef(3, 5, 7), false, \"Delete #4\");\n\t\t\ta(mfn.deleteRef(3, 5, 7), true, \"Delete final\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(i, 2, \"Restarted\");\n\t\t\tmfn(3, 5, 7);\n\t\t\ta(i, 2, \"Cached again\");\n\t\t},\n\t\t\"Primitive: Async\": function (a, d) {\n\t\t\tvar mfn, fn, u = {}, i = 0;\n\t\t\tfn = function (x, y, cb) {\n\t\t\t\tnextTick(function () {\n\t\t\t\t\t++i;\n\t\t\t\t\tcb(null, x + y);\n\t\t\t\t});\n\t\t\t\treturn u;\n\t\t\t};\n\n\t\t\tmfn = memoize(fn, { async: true, primitive: true, refCounter: true });\n\n\t\t\ta(mfn.deleteRef(3, 7), null, \"Delete ref before\");\n\n\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 10], \"Result #1\");\n\t\t\t}), u, \"Initial\");\n\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 10], \"Result #2\");\n\t\t\t}), u, \"Initial #2\");\n\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 13], \"Result B #1\");\n\t\t\t}), u, \"Initial #2\");\n\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 10], \"Result #3\");\n\t\t\t}), u, \"Initial #2\");\n\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\ta.deep([err, res], [null, 13], \"Result B #2\");\n\t\t\t}), u, \"Initial #3\");\n\n\t\t\tnextTick(function () {\n\t\t\t\ta(i, 2, \"Called #2\");\n\n\t\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\t\ta.deep([err, res], [null, 10], \"Again: Result\");\n\t\t\t\t}), u, \"Again: Initial\");\n\t\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\t\ta.deep([err, res], [null, 13], \"Again B: Result\");\n\t\t\t\t}), u, \"Again B: Initial\");\n\n\t\t\t\tnextTick(function () {\n\t\t\t\t\ta(i, 2, \"Again Called #2\");\n\n\t\t\t\t\ta(mfn.deleteRef(3, 7), false, \"Delete ref #1\");\n\t\t\t\t\ta(mfn.deleteRef(3, 7), false, \"Delete ref #2\");\n\t\t\t\t\ta(mfn.deleteRef(3, 7), false, \"Delete ref #3\");\n\t\t\t\t\ta(mfn.deleteRef(3, 7), true, \"Delete ref Final\");\n\n\t\t\t\t\ta(mfn(3, 7, function (err, res) {\n\t\t\t\t\t\ta.deep([err, res], [null, 10], \"Again: Result\");\n\t\t\t\t\t}), u, \"Again: Initial\");\n\t\t\t\t\ta(mfn(5, 8, function (err, res) {\n\t\t\t\t\t\ta.deep([err, res], [null, 13], \"Again B: Result\");\n\t\t\t\t\t}), u, \"Again B: Initial\");\n\n\t\t\t\t\tnextTick(function () {\n\t\t\t\t\t\ta(i, 3, \"Call After delete\");\n\t\t\t\t\t\td();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n};\n"]}