{"version":3,"sources":["race.js"],"names":[],"mappings":";;AAAA,IAAI,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;AACnC,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI,MAAM,GAAG,EAAE,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC;AACtC,IAAI,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC;AAC/B,IAAI,KAAK,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;AAChC,IAAI,KAAK,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;;AAEhC,IAAI,CAAC,MAAM,EAAE,UAAU,CAAC,EAAE;AACtB,KAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACX,QAAI,EAAE,GAAG,CAAE,EAAE,EAAE,KAAK,CAAE,CAAC;;AAEvB,SAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE;AACzB,YAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;AAClE,UAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAChB;AACD,QAAI,IAAI,GAAG,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;;AAExB,QAAI,GAAG,GAAG,CAAC,CAAC;AACZ,MAAE,CAAC,IAAI,CAAC,CAAC;;AAET,MAAE,CAAC,IAAI,CAAC,CAAC;;AAET,aAAS,EAAE,CAAE,IAAI,EAAE,EAAE,EAAE;AACnB,cAAM,CAAC,IAAI,EAAE,KAAK,EAAE,UAAU,GAAG,EAAE;AAC/B,aAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;AACf,kBAAM,CAAC,IAAI,EAAE,UAAU,EAAE,EAAE;AACvB,iBAAC,CAAC,EAAE,CAAC,EAAE,EAAE,cAAc,CAAC,CAAC;AACzB,kBAAE,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU,GAAG,EAAE,IAAI,EAAE;AAC/B,qBAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;AACf,qBAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,GAAG,KAAK,EAAE,KAAK,CAAC,CAAC;AAClC,qBAAC,CAAC,EAAE,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,wBAAwB,CAAC,CAAC;iBACtD,CAAC,CAAC;aACN,CAAC,CAAA;SACL,CAAC,CAAC;KACN;CACJ,CAAC,CAAC","file":"race-compiled.js","sourcesContent":["var mkdirp = require('../').mkdirp;\nvar path = require('path');\nvar fs = require('fs');\nvar exists = fs.exists || path.exists;\nvar test = require('tap').test;\nvar _0777 = parseInt('0777', 8);\nvar _0755 = parseInt('0755', 8);\n\ntest('race', function (t) {\n    t.plan(10);\n    var ps = [ '', 'tmp' ];\n    \n    for (var i = 0; i < 25; i++) {\n        var dir = Math.floor(Math.random() * Math.pow(16,4)).toString(16);\n        ps.push(dir);\n    }\n    var file = ps.join('/');\n    \n    var res = 2;\n    mk(file);\n    \n    mk(file);\n    \n    function mk (file, cb) {\n        mkdirp(file, _0755, function (err) {\n            t.ifError(err);\n            exists(file, function (ex) {\n                t.ok(ex, 'file created');\n                fs.stat(file, function (err, stat) {\n                    t.ifError(err);\n                    t.equal(stat.mode & _0777, _0755);\n                    t.ok(stat.isDirectory(), 'target not a directory');\n                });\n            })\n        });\n    }\n});\n"]}