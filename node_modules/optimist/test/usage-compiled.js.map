{"version":3,"sources":["usage.js"],"names":[],"mappings":"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","file":"usage-compiled.js","sourcesContent":["var Hash = require('hashish');\nvar optimist = require('../index');\nvar test = require('tap').test;\n\ntest('usageFail', function (t) {\n    var r = checkUsage(function () {\n        return optimist('-x 10 -z 20'.split(' '))\n            .usage('Usage: $0 -x NUM -y NUM')\n            .demand(['x','y'])\n            .argv;\n    });\n    t.same(\n        r.result,\n        { x : 10, z : 20, _ : [], $0 : './usage' }\n    );\n\n    t.same(\n        r.errors.join('\\n').split(/\\n+/),\n        [\n            'Usage: ./usage -x NUM -y NUM',\n            'Options:',\n            '  -x  [required]',\n            '  -y  [required]',\n            'Missing required arguments: y',\n        ]\n    );\n    t.same(r.logs, []);\n    t.ok(r.exit);\n    t.end();\n});\n\n\ntest('usagePass', function (t) {\n    var r = checkUsage(function () {\n        return optimist('-x 10 -y 20'.split(' '))\n            .usage('Usage: $0 -x NUM -y NUM')\n            .demand(['x','y'])\n            .argv;\n    });\n    t.same(r, {\n        result : { x : 10, y : 20, _ : [], $0 : './usage' },\n        errors : [],\n        logs : [],\n        exit : false,\n    });\n    t.end();\n});\n\ntest('checkPass', function (t) {\n    var r = checkUsage(function () {\n        return optimist('-x 10 -y 20'.split(' '))\n            .usage('Usage: $0 -x NUM -y NUM')\n            .check(function (argv) {\n                if (!('x' in argv)) throw 'You forgot about -x';\n                if (!('y' in argv)) throw 'You forgot about -y';\n            })\n            .argv;\n    });\n    t.same(r, {\n        result : { x : 10, y : 20, _ : [], $0 : './usage' },\n        errors : [],\n        logs : [],\n        exit : false,\n    });\n    t.end();\n});\n\ntest('checkFail', function (t) {\n    var r = checkUsage(function () {\n        return optimist('-x 10 -z 20'.split(' '))\n            .usage('Usage: $0 -x NUM -y NUM')\n            .check(function (argv) {\n                if (!('x' in argv)) throw 'You forgot about -x';\n                if (!('y' in argv)) throw 'You forgot about -y';\n            })\n            .argv;\n    });\n\n    t.same(\n        r.result,\n        { x : 10, z : 20, _ : [], $0 : './usage' }\n    );\n\n    t.same(\n        r.errors.join('\\n').split(/\\n+/),\n        [\n            'Usage: ./usage -x NUM -y NUM',\n            'You forgot about -y'\n        ]\n    );\n\n    t.same(r.logs, []);\n    t.ok(r.exit);\n    t.end();\n});\n\ntest('checkCondPass', function (t) {\n    function checker (argv) {\n        return 'x' in argv && 'y' in argv;\n    }\n\n    var r = checkUsage(function () {\n        return optimist('-x 10 -y 20'.split(' '))\n            .usage('Usage: $0 -x NUM -y NUM')\n            .check(checker)\n            .argv;\n    });\n    t.same(r, {\n        result : { x : 10, y : 20, _ : [], $0 : './usage' },\n        errors : [],\n        logs : [],\n        exit : false,\n    });\n    t.end();\n});\n\ntest('checkCondFail', function (t) {\n    function checker (argv) {\n        return 'x' in argv && 'y' in argv;\n    }\n\n    var r = checkUsage(function () {\n        return optimist('-x 10 -z 20'.split(' '))\n            .usage('Usage: $0 -x NUM -y NUM')\n            .check(checker)\n            .argv;\n    });\n\n    t.same(\n        r.result,\n        { x : 10, z : 20, _ : [], $0 : './usage' }\n    );\n\n    t.same(\n        r.errors.join('\\n').split(/\\n+/).join('\\n'),\n        'Usage: ./usage -x NUM -y NUM\\n'\n        + 'Argument check failed: ' + checker.toString()\n    );\n\n    t.same(r.logs, []);\n    t.ok(r.exit);\n    t.end();\n});\n\ntest('countPass', function (t) {\n    var r = checkUsage(function () {\n        return optimist('1 2 3 --moo'.split(' '))\n            .usage('Usage: $0 [x] [y] [z] {OPTIONS}')\n            .demand(3)\n            .argv;\n    });\n    t.same(r, {\n        result : { _ : [ '1', '2', '3' ], moo : true, $0 : './usage' },\n        errors : [],\n        logs : [],\n        exit : false,\n    });\n    t.end();\n});\n\ntest('countFail', function (t) {\n    var r = checkUsage(function () {\n        return optimist('1 2 --moo'.split(' '))\n            .usage('Usage: $0 [x] [y] [z] {OPTIONS}')\n            .demand(3)\n            .argv;\n    });\n    t.same(\n        r.result,\n        { _ : [ '1', '2' ], moo : true, $0 : './usage' }\n    );\n\n    t.same(\n        r.errors.join('\\n').split(/\\n+/),\n        [\n            'Usage: ./usage [x] [y] [z] {OPTIONS}',\n            'Not enough non-option arguments: got 2, need at least 3',\n        ]\n    );\n\n    t.same(r.logs, []);\n    t.ok(r.exit);\n    t.end();\n});\n\ntest('defaultSingles', function (t) {\n    var r = checkUsage(function () {\n        return optimist('--foo 50 --baz 70 --powsy'.split(' '))\n            .default('foo', 5)\n            .default('bar', 6)\n            .default('baz', 7)\n            .argv\n        ;\n    });\n    t.same(r.result, {\n        foo : '50',\n        bar : 6,\n        baz : '70',\n        powsy : true,\n        _ : [],\n        $0 : './usage',\n    });\n    t.end();\n});\n\ntest('defaultAliases', function (t) {\n    var r = checkUsage(function () {\n        return optimist('')\n            .alias('f', 'foo')\n            .default('f', 5)\n            .argv\n        ;\n    });\n    t.same(r.result, {\n        f : '5',\n        foo : '5',\n        _ : [],\n        $0 : './usage',\n    });\n    t.end();\n});\n\ntest('defaultHash', function (t) {\n    var r = checkUsage(function () {\n        return optimist('--foo 50 --baz 70'.split(' '))\n            .default({ foo : 10, bar : 20, quux : 30 })\n            .argv\n        ;\n    });\n    t.same(r.result, {\n        _ : [],\n        $0 : './usage',\n        foo : 50,\n        baz : 70,\n        bar : 20,\n        quux : 30,\n    });\n    t.end();\n});\n\ntest('rebase', function (t) {\n    t.equal(\n        optimist.rebase('/home/substack', '/home/substack/foo/bar/baz'),\n        './foo/bar/baz'\n    );\n    t.equal(\n        optimist.rebase('/home/substack/foo/bar/baz', '/home/substack'),\n        '../../..'\n    );\n    t.equal(\n        optimist.rebase('/home/substack/foo', '/home/substack/pow/zoom.txt'),\n        '../pow/zoom.txt'\n    );\n    t.end();\n});\n\nfunction checkUsage (f) {\n\n    var exit = false;\n\n    process._exit = process.exit;\n    process._env = process.env;\n    process._argv = process.argv;\n\n    process.exit = function (t) { exit = true };\n    process.env = Hash.merge(process.env, { _ : 'node' });\n    process.argv = [ './usage' ];\n\n    var errors = [];\n    var logs = [];\n\n    console._error = console.error;\n    console.error = function (msg) { errors.push(msg) };\n    console._log = console.log;\n    console.log = function (msg) { logs.push(msg) };\n\n    var result = f();\n\n    process.exit = process._exit;\n    process.env = process._env;\n    process.argv = process._argv;\n\n    console.error = console._error;\n    console.log = console._log;\n\n    return {\n        errors : errors,\n        logs : logs,\n        exit : exit,\n        result : result,\n    };\n};\n"]}