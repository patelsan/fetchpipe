{"version":3,"sources":["polyfills.js"],"names":[],"mappings":"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","file":"polyfills-compiled.js","sourcesContent":["var fs = require('./fs.js')\nvar constants = require('constants')\n\nvar origCwd = process.cwd\nvar cwd = null\nprocess.cwd = function() {\n  if (!cwd)\n    cwd = origCwd.call(process)\n  return cwd\n}\ntry {\n  process.cwd()\n} catch (er) {}\n\nvar chdir = process.chdir\nprocess.chdir = function(d) {\n  cwd = null\n  chdir.call(process, d)\n}\n\nmodule.exports = patch\n\nfunction patch (fs) {\n  // (re-)implement some things that are known busted or missing.\n\n  // lchmod, broken prior to 0.6.2\n  // back-port the fix here.\n  if (constants.hasOwnProperty('O_SYMLINK') &&\n      process.version.match(/^v0\\.6\\.[0-2]|^v0\\.5\\./)) {\n    patchLchmod(fs)\n  }\n\n  // lutimes implementation, or no-op\n  if (!fs.lutimes) {\n    patchLutimes(fs)\n  }\n\n  // https://github.com/isaacs/node-graceful-fs/issues/4\n  // Chown should not fail on einval or eperm if non-root.\n  // It should not fail on enosys ever, as this just indicates\n  // that a fs doesn't support the intended operation.\n\n  fs.chown = chownFix(fs.chown)\n  fs.fchown = chownFix(fs.fchown)\n  fs.lchown = chownFix(fs.lchown)\n\n  fs.chmod = chownFix(fs.chmod)\n  fs.fchmod = chownFix(fs.fchmod)\n  fs.lchmod = chownFix(fs.lchmod)\n\n  fs.chownSync = chownFixSync(fs.chownSync)\n  fs.fchownSync = chownFixSync(fs.fchownSync)\n  fs.lchownSync = chownFixSync(fs.lchownSync)\n\n  fs.chmodSync = chownFix(fs.chmodSync)\n  fs.fchmodSync = chownFix(fs.fchmodSync)\n  fs.lchmodSync = chownFix(fs.lchmodSync)\n\n  // if lchmod/lchown do not exist, then make them no-ops\n  if (!fs.lchmod) {\n    fs.lchmod = function (path, mode, cb) {\n      process.nextTick(cb)\n    }\n    fs.lchmodSync = function () {}\n  }\n  if (!fs.lchown) {\n    fs.lchown = function (path, uid, gid, cb) {\n      process.nextTick(cb)\n    }\n    fs.lchownSync = function () {}\n  }\n\n  // on Windows, A/V software can lock the directory, causing this\n  // to fail with an EACCES or EPERM if the directory contains newly\n  // created files.  Try again on failure, for up to 1 second.\n  if (process.platform === \"win32\") {\n    fs.rename = (function (fs$rename) { return function (from, to, cb) {\n      var start = Date.now()\n      fs$rename(from, to, function CB (er) {\n        if (er\n            && (er.code === \"EACCES\" || er.code === \"EPERM\")\n            && Date.now() - start < 1000) {\n          return fs$rename(from, to, CB)\n        }\n        if (cb) cb(er)\n      })\n    }})(fs.rename)\n  }\n\n  // if read() returns EAGAIN, then just try it again.\n  fs.read = (function (fs$read) { return function (fd, buffer, offset, length, position, callback_) {\n    var callback\n    if (callback_ && typeof callback_ === 'function') {\n      var eagCounter = 0\n      callback = function (er, _, __) {\n        if (er && er.code === 'EAGAIN' && eagCounter < 10) {\n          eagCounter ++\n          return fs$read.call(fs, fd, buffer, offset, length, position, callback)\n        }\n        callback_.apply(this, arguments)\n      }\n    }\n    return fs$read.call(fs, fd, buffer, offset, length, position, callback)\n  }})(fs.read)\n\n  fs.readSync = (function (fs$readSync) { return function (fd, buffer, offset, length, position) {\n    var eagCounter = 0\n    while (true) {\n      try {\n        return fs$readSync.call(fs, fd, buffer, offset, length, position)\n      } catch (er) {\n        if (er.code === 'EAGAIN' && eagCounter < 10) {\n          eagCounter ++\n          continue\n        }\n        throw er\n      }\n    }\n  }})(fs.readSync)\n}\n\nfunction patchLchmod (fs) {\n  fs.lchmod = function (path, mode, callback) {\n    callback = callback || noop\n    fs.open( path\n           , constants.O_WRONLY | constants.O_SYMLINK\n           , mode\n           , function (err, fd) {\n      if (err) {\n        callback(err)\n        return\n      }\n      // prefer to return the chmod error, if one occurs,\n      // but still try to close, and report closing errors if they occur.\n      fs.fchmod(fd, mode, function (err) {\n        fs.close(fd, function(err2) {\n          callback(err || err2)\n        })\n      })\n    })\n  }\n\n  fs.lchmodSync = function (path, mode) {\n    var fd = fs.openSync(path, constants.O_WRONLY | constants.O_SYMLINK, mode)\n\n    // prefer to return the chmod error, if one occurs,\n    // but still try to close, and report closing errors if they occur.\n    var threw = true\n    var ret\n    try {\n      ret = fs.fchmodSync(fd, mode)\n      threw = false\n    } finally {\n      if (threw) {\n        try {\n          fs.closeSync(fd)\n        } catch (er) {}\n      } else {\n        fs.closeSync(fd)\n      }\n    }\n    return ret\n  }\n}\n\nfunction patchLutimes (fs) {\n  if (constants.hasOwnProperty(\"O_SYMLINK\")) {\n    fs.lutimes = function (path, at, mt, cb) {\n      fs.open(path, constants.O_SYMLINK, function (er, fd) {\n        cb = cb || noop\n        if (er) return cb(er)\n        fs.futimes(fd, at, mt, function (er) {\n          fs.close(fd, function (er2) {\n            return cb(er || er2)\n          })\n        })\n      })\n    }\n\n    fs.lutimesSync = function (path, at, mt) {\n      var fd = fs.openSync(path, constants.O_SYMLINK)\n      var ret\n      var threw = true\n      try {\n        ret = fs.futimesSync(fd, at, mt)\n        threw = false\n      } finally {\n        if (threw) {\n          try {\n            fs.closeSync(fd)\n          } catch (er) {}\n        } else {\n          fs.closeSync(fd)\n        }\n      }\n      return ret\n    }\n\n  } else {\n    fs.lutimes = function (_a, _b, _c, cb) { process.nextTick(cb) }\n    fs.lutimesSync = function () {}\n  }\n}\n\nfunction chownFix (orig) {\n  if (!orig) return orig\n  return function (target, uid, gid, cb) {\n    return orig.call(fs, target, uid, gid, function (er, res) {\n      if (chownErOk(er)) er = null\n      cb(er, res)\n    })\n  }\n}\n\nfunction chownFixSync (orig) {\n  if (!orig) return orig\n  return function (target, uid, gid) {\n    try {\n      return orig.call(fs, target, uid, gid)\n    } catch (er) {\n      if (!chownErOk(er)) throw er\n    }\n  }\n}\n\n// ENOSYS means that the fs doesn't support the op. Just ignore\n// that, because it doesn't matter.\n//\n// if there's no getuid, or if getuid() is something other\n// than 0, and the error is EINVAL or EPERM, then just ignore\n// it.\n//\n// This specific case is a silent failure in cp, install, tar,\n// and most other unix tools that manage permissions.\n//\n// When running as root, or if other types of errors are\n// encountered, then it's strict.\nfunction chownErOk (er) {\n  if (!er)\n    return true\n\n  if (er.code === \"ENOSYS\")\n    return true\n\n  var nonroot = !process.getuid || process.getuid() !== 0\n  if (nonroot) {\n    if (er.code === \"EINVAL\" || er.code === \"EPERM\")\n      return true\n  }\n\n  return false\n}\n"]}