{"version":3,"sources":["hoist.js"],"names":[],"mappings":"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","file":"hoist-compiled.js","sourcesContent":["/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\nvar assert = require(\"assert\");\nvar types = require(\"recast\").types;\nvar n = types.namedTypes;\nvar b = types.builders;\nvar hasOwn = Object.prototype.hasOwnProperty;\n\n// The hoist function takes a FunctionExpression or FunctionDeclaration\n// and replaces any Declaration nodes in its body with assignments, then\n// returns a VariableDeclaration containing just the names of the removed\n// declarations.\nexports.hoist = function(funPath) {\n  assert.ok(funPath instanceof types.NodePath);\n  n.Function.assert(funPath.value);\n\n  var vars = {};\n\n  function varDeclToExpr(vdec, includeIdentifiers) {\n    n.VariableDeclaration.assert(vdec);\n    var exprs = [];\n\n    vdec.declarations.forEach(function(dec) {\n      vars[dec.id.name] = dec.id;\n\n      if (dec.init) {\n        exprs.push(b.assignmentExpression(\n          \"=\", dec.id, dec.init\n        ));\n      } else if (includeIdentifiers) {\n        exprs.push(dec.id);\n      }\n    });\n\n    if (exprs.length === 0)\n      return null;\n\n    if (exprs.length === 1)\n      return exprs[0];\n\n    return b.sequenceExpression(exprs);\n  }\n\n  types.visit(funPath.get(\"body\"), {\n    visitVariableDeclaration: function(path) {\n      var expr = varDeclToExpr(path.value, false);\n      if (expr === null) {\n        path.replace();\n      } else {\n        // We don't need to traverse this expression any further because\n        // there can't be any new declarations inside an expression.\n        return b.expressionStatement(expr);\n      }\n\n      // Since the original node has been either removed or replaced,\n      // avoid traversing it any further.\n      return false;\n    },\n\n    visitForStatement: function(path) {\n      var init = path.value.init;\n      if (n.VariableDeclaration.check(init)) {\n        path.get(\"init\").replace(varDeclToExpr(init, false));\n      }\n      this.traverse(path);\n    },\n\n    visitForInStatement: function(path) {\n      var left = path.value.left;\n      if (n.VariableDeclaration.check(left)) {\n        path.get(\"left\").replace(varDeclToExpr(left, true));\n      }\n      this.traverse(path);\n    },\n\n    visitFunctionDeclaration: function(path) {\n      var node = path.value;\n      vars[node.id.name] = node.id;\n\n      var parentNode = path.parent.node;\n      var assignment = b.expressionStatement(\n        b.assignmentExpression(\n          \"=\",\n          node.id,\n          b.functionExpression(\n            node.id,\n            node.params,\n            node.body,\n            node.generator,\n            node.expression\n          )\n        )\n      );\n\n      if (n.BlockStatement.check(path.parent.node)) {\n        // Insert the assignment form before the first statement in the\n        // enclosing block.\n        path.parent.get(\"body\").unshift(assignment);\n\n        // Remove the function declaration now that we've inserted the\n        // equivalent assignment form at the beginning of the block.\n        path.replace();\n\n      } else {\n        // If the parent node is not a block statement, then we can just\n        // replace the declaration with the equivalent assignment form\n        // without worrying about hoisting it.\n        path.replace(assignment);\n      }\n\n      // Don't hoist variables out of inner functions.\n      return false;\n    },\n\n    visitFunctionExpression: function(path) {\n      // Don't descend into nested function expressions.\n      return false;\n    }\n  });\n\n  var paramNames = {};\n  funPath.get(\"params\").each(function(paramPath) {\n    var param = paramPath.value;\n    if (n.Identifier.check(param)) {\n      paramNames[param.name] = param;\n    } else {\n      // Variables declared by destructuring parameter patterns will be\n      // harmlessly re-declared.\n    }\n  });\n\n  var declarations = [];\n\n  Object.keys(vars).forEach(function(name) {\n    if (!hasOwn.call(paramNames, name)) {\n      declarations.push(b.variableDeclarator(vars[name], null));\n    }\n  });\n\n  if (declarations.length === 0) {\n    return null; // Be sure to handle this case!\n  }\n\n  return b.variableDeclaration(\"var\", declarations);\n};\n"]}