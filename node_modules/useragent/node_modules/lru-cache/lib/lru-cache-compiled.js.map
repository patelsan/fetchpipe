{"version":3,"sources":["lru-cache.js"],"names":[],"mappings":"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","file":"lru-cache-compiled.js","sourcesContent":[";(function () { // closure for web browsers\n\nif (typeof module === 'object' && module.exports) {\n  module.exports = LRUCache\n} else {\n  // just set the global for non-node platforms.\n  this.LRUCache = LRUCache\n}\n\nfunction hOP (obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key)\n}\n\nfunction naiveLength () { return 1 }\n\nfunction LRUCache (options) {\n  if (!(this instanceof LRUCache)) {\n    return new LRUCache(options)\n  }\n\n  var max\n  if (typeof options === 'number') {\n    max = options\n    options = { max: max }\n  }\n\n  if (!options) options = {}\n\n  max = options.max\n\n  var lengthCalculator = options.length || naiveLength\n\n  if (typeof lengthCalculator !== \"function\") {\n    lengthCalculator = naiveLength\n  }\n\n  if (!max || !(typeof max === \"number\") || max <= 0 ) {\n    // a little bit silly.  maybe this should throw?\n    max = Infinity\n  }\n\n  var allowStale = options.stale || false\n\n  var maxAge = options.maxAge || null\n\n  var dispose = options.dispose\n\n  var cache = Object.create(null) // hash of items by key\n    , lruList = Object.create(null) // list of items in order of use recency\n    , mru = 0 // most recently used\n    , lru = 0 // least recently used\n    , length = 0 // number of items in the list\n    , itemCount = 0\n\n\n  // resize the cache when the max changes.\n  Object.defineProperty(this, \"max\",\n    { set : function (mL) {\n        if (!mL || !(typeof mL === \"number\") || mL <= 0 ) mL = Infinity\n        max = mL\n        // if it gets above double max, trim right away.\n        // otherwise, do it whenever it's convenient.\n        if (length > max) trim()\n      }\n    , get : function () { return max }\n    , enumerable : true\n    })\n\n  // resize the cache when the lengthCalculator changes.\n  Object.defineProperty(this, \"lengthCalculator\",\n    { set : function (lC) {\n        if (typeof lC !== \"function\") {\n          lengthCalculator = naiveLength\n          length = itemCount\n          for (var key in cache) {\n            cache[key].length = 1\n          }\n        } else {\n          lengthCalculator = lC\n          length = 0\n          for (var key in cache) {\n            cache[key].length = lengthCalculator(cache[key].value)\n            length += cache[key].length\n          }\n        }\n\n        if (length > max) trim()\n      }\n    , get : function () { return lengthCalculator }\n    , enumerable : true\n    })\n\n  Object.defineProperty(this, \"length\",\n    { get : function () { return length }\n    , enumerable : true\n    })\n\n\n  Object.defineProperty(this, \"itemCount\",\n    { get : function () { return itemCount }\n    , enumerable : true\n    })\n\n  this.forEach = function (fn, thisp) {\n    thisp = thisp || this\n    var i = 0;\n    for (var k = mru - 1; k >= 0 && i < itemCount; k--) if (lruList[k]) {\n      i++\n      var hit = lruList[k]\n      fn.call(thisp, hit.value, hit.key, this)\n    }\n  }\n\n  this.keys = function () {\n    var keys = new Array(itemCount)\n    var i = 0\n    for (var k = mru - 1; k >= 0 && i < itemCount; k--) if (lruList[k]) {\n      var hit = lruList[k]\n      keys[i++] = hit.key\n    }\n    return keys\n  }\n\n  this.values = function () {\n    var values = new Array(itemCount)\n    var i = 0\n    for (var k = mru - 1; k >= 0 && i < itemCount; k--) if (lruList[k]) {\n      var hit = lruList[k]\n      values[i++] = hit.value\n    }\n    return values\n  }\n\n  this.reset = function () {\n    if (dispose) {\n      for (var k in cache) {\n        dispose(k, cache[k].value)\n      }\n    }\n    cache = {}\n    lruList = {}\n    lru = 0\n    mru = 0\n    length = 0\n    itemCount = 0\n  }\n\n  // Provided for debugging/dev purposes only. No promises whatsoever that\n  // this API stays stable.\n  this.dump = function () {\n    return cache\n  }\n\n  this.dumpLru = function () {\n    return lruList\n  }\n\n  this.set = function (key, value) {\n    if (hOP(cache, key)) {\n      // dispose of the old one before overwriting\n      if (dispose) dispose(key, cache[key].value)\n      if (maxAge) cache[key].now = Date.now()\n      cache[key].value = value\n      this.get(key)\n      return true\n    }\n\n    var len = lengthCalculator(value)\n    var age = maxAge ? Date.now() : 0\n    var hit = new Entry(key, value, mru++, len, age)\n\n    // oversized objects fall out of cache automatically.\n    if (hit.length > max) {\n      if (dispose) dispose(key, value)\n      return false\n    }\n\n    length += hit.length\n    lruList[hit.lu] = cache[key] = hit\n    itemCount ++\n\n    if (length > max) trim()\n    return true\n  }\n\n  this.has = function (key) {\n    if (!hOP(cache, key)) return false\n    var hit = cache[key]\n    if (maxAge && (Date.now() - hit.now > maxAge)) {\n      return false\n    }\n    return true\n  }\n\n  this.get = function (key) {\n    if (!hOP(cache, key)) return\n    var hit = cache[key]\n    if (maxAge && (Date.now() - hit.now > maxAge)) {\n      this.del(key)\n      return allowStale ? hit.value : undefined\n    }\n    shiftLU(hit)\n    hit.lu = mru ++\n    lruList[hit.lu] = hit\n    return hit.value\n  }\n\n  this.del = function (key) {\n    del(cache[key])\n  }\n\n  function trim () {\n    while (lru < mru && length > max)\n      del(lruList[lru])\n  }\n\n  function shiftLU(hit) {\n    delete lruList[ hit.lu ]\n    while (lru < mru && !lruList[lru]) lru ++\n  }\n\n  function del(hit) {\n    if (hit) {\n      if (dispose) dispose(hit.key, hit.value)\n      length -= hit.length\n      itemCount --\n      delete cache[ hit.key ]\n      shiftLU(hit)\n    }\n  }\n}\n\n// classy, since V8 prefers predictable objects.\nfunction Entry (key, value, mru, len, age) {\n  this.key = key\n  this.value = value\n  this.lu = mru\n  this.length = len\n  this.now = age\n}\n\n})()\n"]}